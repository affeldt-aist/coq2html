
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp.analysis.kernel</title>
<meta name="description" content="Documentation of Coq module mathcomp.analysis.kernel" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>

<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">
<h1 class="title">Module mathcomp.analysis.kernel</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">HB</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">structures</span>.<br/>
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">all_ssreflect</span> <span class="id">ssralg</span> <span class="id">ssrnum</span> <span class="id">ssrint</span> <span class="id">interval</span> <span class="id">finmap</span>.<br/>
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html">mathcomp_extra</a></span> <span class="id"><a href="mathcomp.classical.boolp.html">boolp</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html">classical_sets</a></span> <span class="id"><a href="mathcomp.classical.functions.html">functions</a></span>.<br/>
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.classical.cardinality.html">cardinality</a></span> <span class="id"><a href="mathcomp.classical.fsbigop.html">fsbigop</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.analysis.reals.html">reals</a></span> <span class="id"><a href="mathcomp.analysis.ereal.html">ereal</a></span> <span class="id"><a href="mathcomp.analysis.signed.html">signed</a></span> <span class="id"><a href="mathcomp.analysis.topology.html">topology</a></span> <span class="id"><a href="mathcomp.analysis.normedtype.html">normedtype</a></span> <span class="id"><a href="mathcomp.analysis.sequences.html">sequences</a></span> <span class="id"><a href="mathcomp.analysis.esum.html">esum</a></span> <span class="id"><a href="mathcomp.analysis.measure.html">measure</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.analysis.numfun.html">numfun</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html">lebesgue_measure</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html">lebesgue_integral</a></span>.<br/>
<br/>
<pre class="ssrdoc">
                                Kernels                                    
                                                                           
This file provides a formation of kernels, s-finite kernels, finite        
kernels, subprobability kernels, and probability kernels. The main         
formalized result is the fact that s-finite kernels are stable by          
composition.                                                               
                                                                           
      R.-ker X ~&gt; Y == kernel from X to Y where X and Y are of type        
                       measurableType                                      
                       The HB class is Kernel.                             
  measure_fam_uub k == the kernel k is uniformly upper-bounded             
    R.-sfker X ~&gt; Y == s-finite kernel                                     
                       The HB class is SFiniteKernel.                      
     R.-fker X ~&gt; Y == finite kernel                                       
                       The HB class is FiniteKernel.                       
    R.-spker X ~&gt; Y == subprobability kernel                               
                       The HB class is SubProbabilityKernel.               
     R.-pker X ~&gt; Y == probability kernel                                  
                       The HB class is ProbabilityKernel.                  
            kseries == countable sum of kernels                            
                       It is declared as an instance of the structure      
                       Kernel. It is also an instance of the structure     
                       SFiniteKernel if the sum is over s-finite kernels.  
              kzero == kernel defined using the mzero measure              
          kdirac mf == kernel defined by a measurable function             
           mset U r == the set of probability measures mu such that        
                       mu U &lt; r                                            
               pset == the sets mset U r with U measurable and r \in [0,1] 
       pprobability == the measurable type generated by pset               
     kprobability m == kernel defined by a probability measure             
         kadd k1 k2 == lifting of the addition of measures to kernels      
             l \; k == composition of kernels                              
                                                                           
ref: R. Affeldt, C. Cohen, A. Saito, Semantics of probabilistic programs   
using s-finite kernels in Coq, CPP 2023                                    
</pre>
<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="kwd">Arguments</span>.<br/>
<span class="id">Unset</span> <span class="id">Strict</span> <span class="kwd">Implicit</span>.<br/>
<span class="id">Unset</span> <span class="id">Printing</span> <span class="kwd">Implicit</span> <span class="id">Defensive</span>.<br/>
<span class="kwd">Import</span> <span class="id">Order.TTheory</span> <span class="id">GRing.Theory</span> <span class="id">Num.Def</span> <span class="id">Num.Theory</span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="mathcomp.analysis.topology.html#numFieldTopology.Exports">numFieldTopology.Exports</a></span>.<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">classical_set_scope</span>.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">ring_scope</span>.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">ereal_scope</span>.<br/>
<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "<span class="id">R</span> .-<span class="id">ker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>"<br/>
&nbsp;&nbsp;(<span class="kwd">at</span> <span class="id">level</span> 42, <span class="id">format</span> "<span class="id">R</span> .-<span class="id">ker</span>  <span class="id">X</span>  ~&gt;  <span class="id">Y</span>").<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "<span class="id">R</span> .-<span class="id">sfker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>"<br/>
&nbsp;&nbsp;(<span class="kwd">at</span> <span class="id">level</span> 42, <span class="id">format</span> "<span class="id">R</span> .-<span class="id">sfker</span>  <span class="id">X</span>  ~&gt;  <span class="id">Y</span>").<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "<span class="id">R</span> .-<span class="id">fker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>"<br/>
&nbsp;&nbsp;(<span class="kwd">at</span> <span class="id">level</span> 42, <span class="id">format</span> "<span class="id">R</span> .-<span class="id">fker</span>  <span class="id">X</span>  ~&gt;  <span class="id">Y</span>").<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "<span class="id">R</span> .-<span class="id">spker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>"<br/>
&nbsp;&nbsp;(<span class="kwd">at</span> <span class="id">level</span> 42, <span class="id">format</span> "<span class="id">R</span> .-<span class="id">spker</span>  <span class="id">X</span>  ~&gt;  <span class="id">Y</span>").<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "<span class="id">R</span> .-<span class="id">pker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>"<br/>
&nbsp;&nbsp;(<span class="kwd">at</span> <span class="id">level</span> 42, <span class="id">format</span> "<span class="id">R</span> .-<span class="id">pker</span>  <span class="id">X</span>  ~&gt;  <span class="id">Y</span>").<br/>
<br/>
<span class="id"><a name="isKernel">HB.mixin</a></span> <span class="kwd">Record</span> <span class="id">isKernel</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id">k</span> : <span class="id">X</span> -&gt; {<span class="id">measure</span> <span class="id">set</span> <span class="id">Y</span> -&gt; \<span class="id">bar</span> <span class="id">R</span>}) := {<br/>
&nbsp;&nbsp;<span class="id">measurable_kernel</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">U</span>, <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id">U</span> -&gt; <span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> [<span class="id">set</span>: <span class="id">X</span>] (<span class="id">k</span> ^~ <span class="id">U</span>) }.<br/>
<br/>
#[<span class="id">short</span>(<span class="id">type</span>=<span class="id">kernel</span>)]<br/>
<span class="id">HB.structure</span> <span class="kwd">Definition</span> <span class="id">Kernel</span> <span class="id">d</span> <span class="id">d</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) :=<br/>
&nbsp;&nbsp;{ <span class="id">k</span> &amp; <span class="id"><a href="mathcomp.analysis.kernel.html#isKernel">isKernel</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">R</span> <span class="id">k</span> }.<br/>
<span class="kwd">Notation</span> "<span class="id">R</span> .-<span class="id">ker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>" := (<span class="id"><a href="mathcomp.analysis.kernel.html#kernel">kernel</a></span> <span class="id">X</span>%<span class="id">type</span> <span class="id">Y</span> <span class="id">R</span>).<br/>
<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_kernel">measurable_kernel</a></span> {<span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>} <span class="id">_</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="kernel_measurable_eq_cst">kernel_measurable_eq_cst</a></span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">T</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">T</span>' : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id">f</span> : <span class="id">R</span>.-<span class="id">ker</span> <span class="id">T</span> ~&gt; <span class="id">T</span>') <span class="id">k</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> [<span class="id">set</span> <span class="id">t</span> | <span class="id">f</span> <span class="id">t</span> [<span class="id">set</span>: <span class="id">T</span>'] == <span class="id">k</span>].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
<span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id">X</span>](<span class="id">_</span> : <span class="id">_</span> = (<span class="id">f</span> ^~ <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span>) @^-1` [<span class="id">set</span> <span class="id">k</span>]); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.classical_sets.html#seteqP">seteqP</a></span>; <span class="id">split</span> =&gt; <span class="id">t</span>/= /<span class="id">eqP</span>.<br/>
<span class="id">have</span> /(<span class="id">_</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT">measurableT</a></span> [<span class="id">set</span> <span class="id">k</span>]) := <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_kernel">measurable_kernel</a></span> <span class="id">f</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT">measurableT</a></span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setTI">setTI</a></span>; <span class="id">exact</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="kernel_measurable_neq_cst">kernel_measurable_neq_cst</a></span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">T</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">T</span>' : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)  (<span class="id">f</span> : <span class="id">R</span>.-<span class="id">ker</span> <span class="id">T</span> ~&gt; <span class="id">T</span>') <span class="id">k</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> [<span class="id">set</span> <span class="id">t</span> | <span class="id">f</span> <span class="id">t</span> [<span class="id">set</span>: <span class="id">T</span>'] != <span class="id">k</span>].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
<span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id">X</span>](<span class="id">_</span> : <span class="id">_</span> = (<span class="id">f</span> ^~ <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span>) @^-1` [<span class="id">set</span>~ <span class="id">k</span>]); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.classical_sets.html#seteqP">seteqP</a></span>; <span class="id">split</span> =&gt; <span class="id">t</span> /<span class="id">eqP</span>.<br/>
<span class="id">have</span> /(<span class="id">_</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT">measurableT</a></span> [<span class="id">set</span>~ <span class="id">k</span>]) := <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_kernel">measurable_kernel</a></span> <span class="id">f</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT">measurableT</a></span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setTI">setTI</a></span>; <span class="id">apply</span> =&gt; //; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.measure.html#measurableC">measurableC</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="kernel_measurable_fun_eq_cst">kernel_measurable_fun_eq_cst</a></span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">T</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">T</span>' : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id">f</span> : <span class="id">R</span>.-<span class="id">ker</span> <span class="id">T</span> ~&gt; <span class="id">T</span>') <span class="id">k</span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> [<span class="id">set</span>: <span class="id">T</span>] (<span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id">f</span> <span class="id">t</span> [<span class="id">set</span>: <span class="id">T</span>'] == <span class="id">k</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
<span class="id">move</span>=&gt; <span class="id">_</span> /= <span class="id">B</span> <span class="id">mB</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setTI">setTI</a></span>.<br/>
<span class="id">have</span> [/<span class="id">eqP</span>-&gt;|/<span class="id">eqP</span>-&gt;|/<span class="id">eqP</span>-&gt;|/<span class="id">eqP</span>-&gt;] := <span class="id"><a href="mathcomp.classical.classical_sets.html#set_bool">set_bool</a></span> <span class="id">B</span>.<br/>
- <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#kernel_measurable_eq_cst">kernel_measurable_eq_cst</a></span>.<br/>
- <span class="id">rewrite</span> (<span class="id">_</span> : <span class="id">_</span> @^-1` <span class="id">_</span> = [<span class="id">set</span> <span class="id">b</span> | <span class="id">f</span> <span class="id">b</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> != <span class="id">k</span>]); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.classical_sets.html#seteqP">seteqP</a></span>; <span class="id">split</span> =&gt; [<span class="id">t</span> /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbT">negbT</a></span>//|<span class="id">t</span> /<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">negbTE</a></span>].<br/>
&nbsp;&nbsp;<span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#kernel_measurable_neq_cst">kernel_measurable_neq_cst</a></span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage_set0">preimage_set0</a></span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage_setT">preimage_setT</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eq_kernel">eq_kernel</a></span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">T</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">T</span>' : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id">k1</span> <span class="id">k2</span> : <span class="id">R</span>.-<span class="id">ker</span> <span class="id">T</span> ~&gt; <span class="id">T</span>') :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">U</span>, <span class="id">k1</span> <span class="id">x</span> <span class="id">U</span> = <span class="id">k2</span> <span class="id">x</span> <span class="id">U</span>) -&gt; <span class="id">k1</span> = <span class="id">k2</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
<span class="id">move</span>: <span class="id">k1</span> <span class="id">k2</span> =&gt; [<span class="id">m1</span> [[?]]] [<span class="id">m2</span> [[?]]] /= <span class="id">k12</span>.<br/>
<span class="id">have</span> ? : <span class="id">m1</span> = <span class="id">m2</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; <span class="id">t</span>; <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.measure.html#eq_measure">eq_measure</a></span>; <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; <span class="id">U</span>; <span class="id">rewrite</span> <span class="id">k12</span>.<br/>
<span class="kwd">by</span> <span class="id">subst</span> <span class="id">m1</span>; <span class="id">f_equal</span>; <span class="id">f_equal</span>; <span class="id">f_equal</span>; <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#Prop_irrelevance">Prop_irrelevance</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="kseries">kseries</a></span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>).<br/>
<span class="kwd">Variable</span> <span class="id"><a name="kseries.k">k</a></span> : (<span class="id"><a href="mathcomp.analysis.kernel.html#kseries.R">R</a></span>.-<span class="id">ker</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kseries.X">X</a></span> ~&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#kseries.Y">Y</a></span>)^<span class="id">nat</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="kseries">kseries</a></span> : <span class="id"><a href="mathcomp.analysis.kernel.html#kseries.X">X</a></span> -&gt; {<span class="id">measure</span> <span class="id">set</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kseries.Y">Y</a></span> -&gt; \<span class="id">bar</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kseries.R">R</a></span>} :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">x</span> =&gt; [<span class="id">the</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measure.Exports.measure">measure</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.measure.html#mseries">mseries</a></span> (<span class="id"><a href="mathcomp.analysis.kernel.html#kseries.k">k</a></span> ^~ <span class="id">x</span>) 0].<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="measurable_fun_kseries">measurable_fun_kseries</a></span> (<span class="id">U</span> : <span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#kseries.Y">Y</a></span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id">U</span> -&gt; <span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> [<span class="id">set</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#kseries.X">X</a></span>] (<span class="id"><a href="mathcomp.analysis.kernel.html#kseries">kseries</a></span> ^~ <span class="id">U</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
<span class="id">move</span>=&gt; <span class="id">mU</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#ge0_emeasurable_fun_sum">ge0_emeasurable_fun_sum</a></span> =&gt; // <span class="id">n</span>; <span class="id">exact</span>/<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_kernel">measurable_kernel</a></span>.<br/>
Qed.</div>
<br/>
<span class="id"><a name="HB_unnamed_factory_6">HB.instance</a></span> <span class="kwd">Definition</span> <span class="id">_</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.kernel.html#Build">isKernel.Build</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kseries">kseries</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_kseries">measurable_fun_kseries</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kseries">kseries</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="integral_kseries">integral_kseries</a></span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>')<br/>
&nbsp;&nbsp;(<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id">k</span> : (<span class="id">R</span>.-<span class="id">ker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>)^<span class="id">nat</span>) (<span class="id">f</span> : <span class="id">Y</span> -&gt; \<span class="id">bar</span> <span class="id">R</span>) <span class="id">x</span> :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">y</span>, 0 &lt;= <span class="id">f</span> <span class="id">y</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> [<span class="id">set</span>: <span class="id">Y</span>] <span class="id">f</span> -&gt;<br/>
&nbsp;&nbsp;\<span class="id">int</span>[<span class="id"><a href="mathcomp.analysis.kernel.html#kseries">kseries</a></span> <span class="id">k</span> <span class="id">x</span>]<span class="id">_y</span> (<span class="id">f</span> <span class="id">y</span>) = \<span class="id">sum_</span>(<span class="id">i</span> &lt;<span class="id">oo</span>) \<span class="id">int</span>[<span class="id">k</span> <span class="id">i</span> <span class="id">x</span>]<span class="id">_y</span> (<span class="id">f</span> <span class="id">y</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">f0</span> <span class="id">mf</span>; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.kernel.html#kseries">kseries</a></span>/= <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#ge0_integral_measure_series">ge0_integral_measure_series</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="measure_fam_uub">measure_fam_uub</a></span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id">numFieldType</span>).<br/>
<span class="kwd">Variable</span> <span class="id"><a name="measure_fam_uub.k">k</a></span> : <span class="id"><a href="mathcomp.analysis.kernel.html#measure_fam_uub.X">X</a></span> -&gt; {<span class="id">measure</span> <span class="id">set</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measure_fam_uub.Y">Y</a></span> -&gt; \<span class="id">bar</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measure_fam_uub.R">R</a></span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="measure_fam_uub">measure_fam_uub</a></span> := <span class="kwd">exists</span> <span class="id">r</span>, <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="mathcomp.analysis.kernel.html#measure_fam_uub.k">k</a></span> <span class="id">x</span> [<span class="id">set</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#measure_fam_uub.Y">Y</a></span>] &lt; <span class="id">r</span>%:<span class="id">E</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="measure_fam_uubP">measure_fam_uubP</a></span> : <span class="id"><a href="mathcomp.analysis.kernel.html#measure_fam_uub">measure_fam_uub</a></span> &lt;-&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">r</span> : {<span class="id">posnum</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measure_fam_uub.R">R</a></span>}, <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="mathcomp.analysis.kernel.html#measure_fam_uub.k">k</a></span> <span class="id">x</span> [<span class="id">set</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#measure_fam_uub.Y">Y</a></span>] &lt; <span class="id">r</span>%:<span class="id">num</span>%:<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
<span class="id">split</span> =&gt; [|] [<span class="id">r</span> <span class="id">kr</span>]; <span class="id">last</span> <span class="kwd">by</span> <span class="kwd">exists</span> <span class="id">r</span>%:<span class="id">num</span>.<br/>
<span class="id">suff</span> <span class="id">r_gt0</span> : (0 &lt; <span class="id">r</span>)%<span class="id">R</span> <span class="kwd">by</span> <span class="kwd">exists</span> (<span class="id"><a href="mathcomp.analysis.signed.html#PosNum">PosNum</a></span> <span class="id">r_gt0</span>).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lte_fin">lte_fin</a></span>; <span class="id">apply</span>: (<span class="id">le_lt_trans</span> <span class="id">_</span> (<span class="id">kr</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#point">point</a></span>)).<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measure_fam_uub">measure_fam_uub</a></span>.<br/>
<br/>
<span class="id"><a name="Kernel_isSFinite_subdef">HB.mixin</a></span> <span class="kwd">Record</span> <span class="id">Kernel_isSFinite_subdef</span> <span class="id">d</span> <span class="id">d</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span> : <span class="id">X</span> -&gt; {<span class="id">measure</span> <span class="id">set</span> <span class="id">Y</span> -&gt; \<span class="id">bar</span> <span class="id">R</span>}) := {<br/>
&nbsp;&nbsp;<span class="id">sfinite_kernel_subdef</span> : <span class="kwd">exists2</span> <span class="id">s</span> : (<span class="id">R</span>.-<span class="id">ker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>)^<span class="id">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="mathcomp.analysis.kernel.html#measure_fam_uub">measure_fam_uub</a></span> (<span class="id">s</span> <span class="id">n</span>) &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">U</span>, <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id">U</span> -&gt; <span class="id">k</span> <span class="id">x</span> <span class="id">U</span> = <span class="id"><a href="mathcomp.analysis.kernel.html#kseries">kseries</a></span> <span class="id">s</span> <span class="id">x</span> <span class="id">U</span> }.<br/>
<br/>
<span class="id"><a name="SFiniteKernel">HB.structure</a></span> <span class="kwd">Definition</span> <span class="id">SFiniteKernel</span> <span class="id">d</span> <span class="id">d</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) :=<br/>
&nbsp;&nbsp;{ <span class="id">k</span> <span class="id">of</span> @<span class="id"><a href="mathcomp.analysis.kernel.html#Kernel">Kernel</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">R</span> <span class="id">k</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.kernel.html#Kernel_isSFinite_subdef">Kernel_isSFinite_subdef</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">R</span> <span class="id">k</span> }.<br/>
<span class="kwd">Notation</span> "<span class="id">R</span> .-<span class="id">sfker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>" := (<span class="id"><a href="mathcomp.analysis.kernel.html#type">SFiniteKernel.type</a></span> <span class="id">X</span>%<span class="id">type</span> <span class="id">Y</span> <span class="id">R</span>).<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite_kernel_subdef">sfinite_kernel_subdef</a></span> {<span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>} <span class="id">_</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eq_sfkernel">eq_sfkernel</a></span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">T</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">T</span>' : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id">k1</span> <span class="id">k2</span> : <span class="id">R</span>.-<span class="id">sfker</span> <span class="id">T</span> ~&gt; <span class="id">T</span>') :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">U</span>, <span class="id">k1</span> <span class="id">x</span> <span class="id">U</span> = <span class="id">k2</span> <span class="id">x</span> <span class="id">U</span>) -&gt; <span class="id">k1</span> = <span class="id">k2</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
<span class="id">move</span>: <span class="id">k1</span> <span class="id">k2</span> =&gt; [<span class="id">m1</span> [[?] [?]]] [<span class="id">m2</span> [[?] [?]]] /= <span class="id">k12</span>.<br/>
<span class="id">have</span> ? : <span class="id">m1</span> = <span class="id">m2</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; <span class="id">t</span>; <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.measure.html#eq_measure">eq_measure</a></span>; <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; <span class="id">U</span>; <span class="id">rewrite</span> <span class="id">k12</span>.<br/>
<span class="kwd">by</span> <span class="id">subst</span> <span class="id">m1</span>; <span class="id">f_equal</span>; <span class="id">f_equal</span>; <span class="id">f_equal</span>; <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#Prop_irrelevance">Prop_irrelevance</a></span>.<br/>
Qed.</div>
<br/>
<span class="id"><a name="SFiniteKernel_isFinite">HB.mixin</a></span> <span class="kwd">Record</span> <span class="id">SFiniteKernel_isFinite</span> <span class="id">d</span> <span class="id">d</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span> : <span class="id">X</span> -&gt; {<span class="id">measure</span> <span class="id">set</span> <span class="id">Y</span> -&gt; \<span class="id">bar</span> <span class="id">R</span>}) := {<br/>
&nbsp;&nbsp;<span class="id">measure_uub</span> : <span class="id"><a href="mathcomp.analysis.kernel.html#measure_fam_uub">measure_fam_uub</a></span> <span class="id">k</span> }.<br/>
<br/>
#[<span class="id">short</span>(<span class="id">type</span>=<span class="id">finite_kernel</span>)]<br/>
<span class="id">HB.structure</span> <span class="kwd">Definition</span> <span class="id">FiniteKernel</span> <span class="id">d</span> <span class="id">d</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) :=<br/>
&nbsp;&nbsp;{ <span class="id">k</span> <span class="id">of</span> @<span class="id"><a href="mathcomp.analysis.kernel.html#SFiniteKernel">SFiniteKernel</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">k</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.kernel.html#SFiniteKernel_isFinite">SFiniteKernel_isFinite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">R</span> <span class="id">k</span> }.<br/>
<span class="kwd">Notation</span> "<span class="id">R</span> .-<span class="id">fker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>" := (<span class="id"><a href="mathcomp.analysis.kernel.html#finite_kernel">finite_kernel</a></span> <span class="id">X</span>%<span class="id">type</span> <span class="id">Y</span> <span class="id">R</span>).<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measure_uub">measure_uub</a></span> {<span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>} <span class="id">_</span>.<br/>
<br/>
<span class="id"><a name="Kernel_isFinite">HB.factory</a></span> <span class="kwd">Record</span> <span class="id">Kernel_isFinite</span> <span class="id">d</span> <span class="id">d</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span> : <span class="id">X</span> -&gt; {<span class="id">measure</span> <span class="id">set</span> <span class="id">Y</span> -&gt; \<span class="id">bar</span> <span class="id">R</span>}) <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.kernel.html#isKernel">isKernel</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">k</span> := {<br/>
&nbsp;&nbsp;<span class="id">measure_uub</span> : <span class="id"><a href="mathcomp.analysis.kernel.html#measure_fam_uub">measure_fam_uub</a></span> <span class="id">k</span> }.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="kzero">kzero</a></span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="kzero">kzero</a></span> : <span class="id"><a href="mathcomp.analysis.kernel.html#kzero.X">X</a></span> -&gt; {<span class="id">measure</span> <span class="id">set</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kzero.Y">Y</a></span> -&gt; \<span class="id">bar</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kzero.R">R</a></span>} :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="mathcomp.analysis.kernel.html#kzero.X">X</a></span> =&gt; [<span class="id">the</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measure.Exports.measure">measure</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.measure.html#mzero">mzero</a></span>].<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="kzero.measurable_fun_kzero">measurable_fun_kzero</a></span> <span class="id">U</span> : <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id">U</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> [<span class="id">set</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#kzero.X">X</a></span>] (<span class="id"><a href="mathcomp.analysis.kernel.html#kzero">kzero</a></span> ^~ <span class="id">U</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ?/=; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.measure.html#measurable_cst">measurable_cst</a></span>. Qed.</div>
<br/>
<span class="id"><a name="HB_unnamed_factory_21">HB.instance</a></span> <span class="kwd">Definition</span> <span class="id">_</span> :=<br/>
&nbsp;&nbsp;@<span class="id"><a href="mathcomp.analysis.kernel.html#Build">isKernel.Build</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kzero.X">X</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#kzero.Y">Y</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#kzero.R">R</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#kzero">kzero</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#kzero.measurable_fun_kzero">measurable_fun_kzero</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="kzero_uub">kzero_uub</a></span> : <span class="id"><a href="mathcomp.analysis.kernel.html#measure_fam_uub">measure_fam_uub</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#kzero">kzero</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
 <span class="kwd">by</span> <span class="kwd">exists</span> 1%<span class="id">R</span> =&gt; /= <span class="id">t</span>; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.measure.html#mzero">mzero</a></span>/=. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kzero">kzero</a></span>.<br/>
<br/>
<span class="id"><a name="Builders_23">HB.builders</a></span> <span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>')<br/>
&nbsp;&nbsp;(<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) <span class="id">k</span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.kernel.html#Kernel_isFinite">Kernel_isFinite</a></span> <span class="id">d</span> <span class="id">d</span>' <span class="id">X</span> <span class="id">Y</span> <span class="id">R</span> <span class="id">k</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="Builders_23.Builders_23.sfinite_finite">sfinite_finite</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">exists2</span> <span class="id">k_</span> : (<span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23.R">R</a></span>.-<span class="id">ker</span> <span class="id">_</span> ~&gt; <span class="id">_</span>)^<span class="id">nat</span>, <span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="mathcomp.analysis.kernel.html#measure_fam_uub">measure_fam_uub</a></span> (<span class="id">k_</span> <span class="id">n</span>) &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">U</span>, <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id">U</span> -&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23.k">k</a></span> <span class="id">x</span> <span class="id">U</span> = <span class="id"><a href="mathcomp.analysis.measure.html#mseries">mseries</a></span> (<span class="id">k_</span> ^~ <span class="id">x</span>) 0 <span class="id">U</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
<span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="kwd">if</span> <span class="id">n</span> <span class="id">is</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#O">O</a></span> <span class="kwd">then</span> [<span class="id">the</span> <span class="id">_</span>.-<span class="id">ker</span> <span class="id">_</span> ~&gt; <span class="id">_</span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23.k">k</a></span>] <span class="kwd">else</span><br/>
&nbsp;&nbsp;[<span class="id">the</span> <span class="id">_</span>.-<span class="id">ker</span> <span class="id">_</span> ~&gt; <span class="id">_</span> <span class="id">of</span> @<span class="id"><a href="mathcomp.analysis.kernel.html#kzero">kzero</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23.X">X</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23.Y">Y</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23.R">R</a></span>]).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">case</span> =&gt; [|<span class="id">_</span>]; [<span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.measure_uub">measure_uub</a></span>|<span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#kzero_uub">kzero_uub</a></span>].<br/>
<span class="id">move</span>=&gt; <span class="id">t</span> <span class="id">U</span> <span class="id">mU</span>/=; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.measure.html#mseries">mseries</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="mathcomp.analysis.sequences.html#nneseries_split">nneseries_split</a></span> 1%<span class="id">N</span>)// <span class="id">big_ord_recl</span>/= <span class="id">big_ord0</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#adde0">adde0</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.sequences.html#ereal_series">ereal_series</a></span> (@<span class="id"><a href="mathcomp.analysis.sequences.html#eq_eseriesr">eq_eseriesr</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="kwd">fun</span>=&gt; 0%<span class="id">E</span>)); <span class="id">last</span> <span class="kwd">by</span> <span class="id">case</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.sequences.html#eseries0">eseries0</a></span>// <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#adde0">adde0</a></span>.<br/>
Qed.</div>
<br/>
<span class="id"><a name="Builders_23.HB_unnamed_factory_25">HB.instance</a></span> <span class="kwd">Definition</span> <span class="id">_</span> :=<br/>
&nbsp;&nbsp;@<span class="id"><a href="mathcomp.analysis.kernel.html#Kernel_isSFinite_subdef.Build">Kernel_isSFinite_subdef.Build</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23.d">d</a></span> <span class="id">d</span>' <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23.X">X</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23.Y">Y</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23.R">R</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23.k">k</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23.sfinite_finite">sfinite_finite</a></span>.<br/>
<br/>
<span class="id"><a name="Builders_23.HB_unnamed_factory_27">HB.instance</a></span> <span class="kwd">Definition</span> <span class="id">_</span> :=<br/>
&nbsp;&nbsp;@<span class="id"><a href="mathcomp.analysis.kernel.html#SFiniteKernel_isFinite.Build">SFiniteKernel_isFinite.Build</a></span>  <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23.d">d</a></span> <span class="id">d</span>' <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23.X">X</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23.Y">Y</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23.R">R</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23.k">k</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.measure_uub">measure_uub</a></span>.<br/>
<br/>
<span class="id"><a href="mathcomp.analysis.kernel.html#Builders_23.Builders_23">HB.end</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="sfinite">sfinite</a></span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>').<br/>
<span class="kwd">Variables</span> (<span class="id"><a name="sfinite.R">R</a></span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id"><a name="sfinite.k">k</a></span> : <span class="id">R</span>.-<span class="id">sfker</span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.X">X</a></span> ~&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.Y">Y</a></span>).<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="sfinite.s">s</a></span> : (<span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.X">X</a></span> -&gt; {<span class="id">measure</span> <span class="id">set</span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.Y">Y</a></span> -&gt; \<span class="id">bar</span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.R">R</a></span>})^<span class="id">nat</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#exist2">exist2</a></span> <span class="id">x</span> <span class="id">_</span> <span class="id">_</span> := <span class="id"><a href="mathcomp.classical.boolp.html#cid2">cid2</a></span> (<span class="id"><a href="mathcomp.analysis.kernel.html#sfinite_kernel_subdef">sfinite_kernel_subdef</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.k">k</a></span>) <span class="kwd">in</span> <span class="id">x</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="sfinite.ms">ms</a></span> <span class="id">n</span> : @<span class="id"><a href="mathcomp.analysis.kernel.html#isKernel">isKernel</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.d">d</a></span> <span class="id">d</span>' <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.X">X</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.Y">Y</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.R">R</a></span> (<span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.s">s</a></span> <span class="id">n</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
<span class="id">split</span>; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.s">s</a></span>; <span class="id">case</span>: <span class="id"><a href="mathcomp.classical.boolp.html#cid2">cid2</a></span> =&gt; /= <span class="id">s</span>' <span class="id">s</span>'<span class="id">_uub</span> <span class="id">kE</span>.<br/>
<span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_kernel">measurable_kernel</a></span>.<br/>
Qed.</div>
<br/>
<span class="id"><a name="sfinite.hb_instance_29">HB.instance</a></span> <span class="kwd">Definition</span> <span class="id">_</span> <span class="id">n</span> := <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.ms">ms</a></span> <span class="id">n</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="sfinite.s_uub">s_uub</a></span> <span class="id">n</span> : <span class="id"><a href="mathcomp.analysis.kernel.html#measure_fam_uub">measure_fam_uub</a></span> (<span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.s">s</a></span> <span class="id">n</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.s">s</a></span>; <span class="id">case</span>: <span class="id"><a href="mathcomp.classical.boolp.html#cid2">cid2</a></span>. Qed.</div>
<br/>
<span class="id"><a name="sfinite.hb_instance_32">HB.instance</a></span> <span class="kwd">Definition</span> <span class="id">_</span> <span class="id">n</span> := @<span class="id"><a href="mathcomp.analysis.kernel.html#Build">Kernel_isFinite.Build</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.d">d</a></span> <span class="id">d</span>' <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.X">X</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.Y">Y</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.R">R</a></span> (<span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.s">s</a></span> <span class="id">n</span>) (<span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.s_uub">s_uub</a></span> <span class="id">n</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sfinite_kernel">sfinite_kernel</a></span> : <span class="kwd">exists</span> <span class="id">s</span> : (<span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.R">R</a></span>.-<span class="id">fker</span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.X">X</a></span> ~&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.Y">Y</a></span>)^<span class="id">nat</span>,<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">U</span>, <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id">U</span> -&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.k">k</a></span> <span class="id">x</span> <span class="id">U</span> = <span class="id"><a href="mathcomp.analysis.kernel.html#kseries">kseries</a></span> <span class="id">s</span> <span class="id">x</span> <span class="id">U</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
<span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; [<span class="id">the</span> <span class="id">_</span>.-<span class="id">fker</span> <span class="id">_</span> ~&gt; <span class="id">_</span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.s">s</a></span> <span class="id">n</span>]) =&gt; <span class="id">x</span> <span class="id">U</span> <span class="id">mU</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.s">s</a></span> /= /<span class="id"><a href="mathcomp.analysis.kernel.html#sfinite.s">s</a></span>; <span class="kwd">by</span> <span class="id">case</span>: <span class="id"><a href="mathcomp.classical.boolp.html#cid2">cid2</a></span> =&gt; ? ? -&gt;.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite">sfinite</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sfinite_kernel_measure">sfinite_kernel_measure</a></span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">Z</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id">k</span> : <span class="id">R</span>.-<span class="id">sfker</span> <span class="id">Z</span> ~&gt; <span class="id">X</span>) (<span class="id">z</span> : <span class="id">Z</span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#sfinite_measure">sfinite_measure</a></span> (<span class="id">k</span> <span class="id">z</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
<span class="id">have</span> [<span class="id">s</span> <span class="id">ks</span>] := <span class="id"><a href="mathcomp.analysis.kernel.html#sfinite_kernel">sfinite_kernel</a></span> <span class="id">k</span>.<br/>
<span class="kwd">exists</span> (<span class="id">s</span> ^~ <span class="id">z</span>).<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">n</span>; <span class="id">have</span> [<span class="id">r</span> <span class="id">snr</span>] := <span class="id"><a href="mathcomp.analysis.kernel.html#measure_uub">measure_uub</a></span> (<span class="id">s</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.measure.html#lty_fin_num_fun">lty_fin_num_fun</a></span>; <span class="id">rewrite</span> (<span class="id">lt_le_trans</span> (<span class="id">snr</span> <span class="id">_</span>))// <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#leey">leey</a></span>.<br/>
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">U</span> <span class="id">mU</span>; <span class="id">rewrite</span> <span class="id">ks</span>.<br/>
Qed.</div>
<br/>
<span class="id"><a name="hb_instance_38">HB.instance</a></span> <span class="kwd">Definition</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d</span> <span class="id">d</span>' (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) :=<br/>
&nbsp;&nbsp;@<span class="id"><a href="mathcomp.analysis.kernel.html#Build">Kernel_isFinite.Build</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">R</span> (@<span class="id"><a href="mathcomp.analysis.kernel.html#kzero">kzero</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="mathcomp.analysis.kernel.html#kzero_uub">kzero_uub</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">R</span>).<br/>
<br/>
<span class="id"><a name="Kernel_isSFinite">HB.factory</a></span> <span class="kwd">Record</span> <span class="id">Kernel_isSFinite</span> <span class="id">d</span> <span class="id">d</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span> : <span class="id">X</span> -&gt; {<span class="id">measure</span> <span class="id">set</span> <span class="id">Y</span> -&gt; \<span class="id">bar</span> <span class="id">R</span>}) <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.kernel.html#isKernel">isKernel</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">k</span> := {<br/>
&nbsp;&nbsp;<span class="id">sfinite</span> : <span class="kwd">exists</span> <span class="id">s</span> : (<span class="id">R</span>.-<span class="id">fker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>)^<span class="id">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">U</span>, <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id">U</span> -&gt; <span class="id">k</span> <span class="id">x</span> <span class="id">U</span> = <span class="id"><a href="mathcomp.analysis.kernel.html#kseries">kseries</a></span> <span class="id">s</span> <span class="id">x</span> <span class="id">U</span> }.<br/>
<br/>
<span class="id"><a name="Builders_46">HB.builders</a></span> <span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>')<br/>
&nbsp;&nbsp;(<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) <span class="id">k</span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.kernel.html#Kernel_isSFinite">Kernel_isSFinite</a></span> <span class="id">d</span> <span class="id">d</span>' <span class="id">X</span> <span class="id">Y</span> <span class="id">R</span> <span class="id">k</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Builders_46.sfinite_subdef">sfinite_subdef</a></span> : <span class="id"><a href="mathcomp.analysis.kernel.html#Kernel_isSFinite_subdef">Kernel_isSFinite_subdef</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_46.Builders_46.d">d</a></span> <span class="id">d</span>' <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_46.Builders_46.X">X</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_46.Builders_46.Y">Y</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_46.Builders_46.R">R</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_46.Builders_46.k">k</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
<span class="id">split</span>; <span class="id">have</span> [<span class="id">s</span> <span class="id">sE</span>] := <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_46.sfinite">sfinite</a></span>; <span class="kwd">exists</span> <span class="id">s</span> =&gt; //.<br/>
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">n</span>; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#measure_uub">measure_uub</a></span>.<br/>
Qed.</div>
<br/>
<span class="id"><a name="Builders_46.HB_unnamed_factory_48">HB.instance</a></span> <span class="kwd">Definition</span> <span class="id">_</span> :=  <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_46.sfinite_subdef">sfinite_subdef</a></span>.<br/>
<br/>
<span class="id"><a href="mathcomp.analysis.kernel.html#Builders_46.Builders_46">HB.end</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="sfkseries">sfkseries</a></span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>).<br/>
<span class="kwd">Variables</span> <span class="id"><a name="sfkseries.k">k</a></span> : (<span class="id"><a href="mathcomp.analysis.kernel.html#sfkseries.R">R</a></span>.-<span class="id">sfker</span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfkseries.X">X</a></span> ~&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#sfkseries.Y">Y</a></span>)^<span class="id">nat</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="sfkseries.sfinite_kseries">sfinite_kseries</a></span> : <span class="kwd">exists2</span> <span class="id">k_</span> : (<span class="id"><a href="mathcomp.analysis.kernel.html#sfkseries.R">R</a></span>.-<span class="id">ker</span> <span class="id">_</span> ~&gt; <span class="id">_</span>)^<span class="id">nat</span>,<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="mathcomp.analysis.kernel.html#measure_fam_uub">measure_fam_uub</a></span> (<span class="id">k_</span> <span class="id">n</span>) &amp;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">U</span>, <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id">U</span> -&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#kseries">kseries</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfkseries.k">k</a></span> <span class="id">x</span> <span class="id">U</span> = <span class="id"><a href="mathcomp.analysis.measure.html#mseries">mseries</a></span> (<span class="id">k_</span> ^~ <span class="id">x</span>) 0 <span class="id">U</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
<span class="id">have</span> /<span class="id"><a href="mathcomp.classical.cardinality.html#ppcard_eqP">ppcard_eqP</a></span>[<span class="id">f</span>] : ([<span class="id">set</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>] #= [<span class="id">set</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> * <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>])%<span class="id">card</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.cardinality.html#card_eq_sym">card_eq_sym</a></span>; <span class="id">exact</span>: <span class="id"><a href="mathcomp.classical.cardinality.html#card_nat2">card_nat2</a></span>.<br/>
<span class="id">pose</span> <span class="id">p</span> <span class="id">n</span> : (<span class="id"><a href="mathcomp.analysis.kernel.html#sfkseries.R">R</a></span>.-<span class="id">fker</span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfkseries.X">X</a></span> ~&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#sfkseries.Y">Y</a></span>)^<span class="id">nat</span> := <span class="id">sval</span> (<span class="id"><a href="mathcomp.classical.boolp.html#cid">cid</a></span> (<span class="id"><a href="mathcomp.analysis.kernel.html#sfinite_kernel">sfinite_kernel</a></span> (<span class="id"><a href="mathcomp.analysis.kernel.html#sfkseries.k">k</a></span> <span class="id">n</span>))).<br/>
<span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">p</span> (<span class="id">f</span> <span class="id">i</span>).1 (<span class="id">f</span> <span class="id">i</span>).2).<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">n</span>; <span class="id">have</span> [<span class="id">r</span> <span class="id">Hr</span>] := <span class="id"><a href="mathcomp.analysis.kernel.html#measure_uub">measure_uub</a></span> (<span class="id">p</span> (<span class="id">f</span> <span class="id">n</span>).1 (<span class="id">f</span> <span class="id">n</span>).2).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="kwd">exists</span> <span class="id">r</span> =&gt; <span class="id">x</span> /=; <span class="id">exact</span>: <span class="id">Hr</span>.<br/>
<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">U</span> <span class="id">mU</span>; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.kernel.html#kseries">kseries</a></span> /<span class="id"><a href="mathcomp.analysis.measure.html#mseries">mseries</a></span>/= /<span class="id"><a href="mathcomp.analysis.measure.html#mseries">mseries</a></span>/=.<br/>
<span class="id">have</span> <span class="id">kE</span> <span class="id">i</span> : <span class="id"><a href="mathcomp.analysis.kernel.html#sfkseries.k">k</a></span> <span class="id">i</span> <span class="id">x</span> <span class="id">U</span> = \<span class="id">sum_</span>(<span class="id">j</span> &lt;<span class="id">oo</span>) <span class="id">p</span> <span class="id">i</span> <span class="id">j</span> <span class="id">x</span> <span class="id">U</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">p</span> /<span class="id">sval</span>/=; <span class="id">case</span>: <span class="id"><a href="mathcomp.classical.boolp.html#cid">cid</a></span> =&gt; <span class="id">k_</span> -&gt;.<br/>
<span class="id">transitivity</span> (\<span class="id">esum_</span>(<span class="id">l</span> <span class="kwd">in</span> [<span class="id">set</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>] `*` [<span class="id">set</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>]) <span class="id">p</span> <span class="id">l</span>.1 <span class="id">l</span>.2 <span class="id">x</span> <span class="id">U</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">_</span> : <span class="id">_</span> `*` <span class="id">_</span> = <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> `*`` (<span class="kwd">fun</span>=&gt; <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span>)); <span class="id">last</span> <span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.classical_sets.html#seteqP">seteqP</a></span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -(@<span class="id"><a href="mathcomp.analysis.esum.html#esum_esum">esum_esum</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; <span class="id">p</span> <span class="id">i</span> <span class="id">j</span> <span class="id">x</span> <span class="id">U</span>))//.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.esum.html#nneseries_esum">nneseries_esum</a></span>// -<span class="id"><a href="mathcomp.classical.classical_sets.html#fun_true">fun_true</a></span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.esum.html#eq_esum">eq_esum</a></span> =&gt; <span class="id">i</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">kE</span>// <span class="id"><a href="mathcomp.analysis.esum.html#nneseries_esum">nneseries_esum</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="mathcomp.analysis.esum.html#reindex_esum">reindex_esum</a></span> [<span class="id">set</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>] <span class="id">_</span> <span class="id">f</span>)//; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> := @<span class="id"><a href="mathcomp.classical.functions.html#bijTT">bijTT</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">f</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id"><a href="mathcomp.classical.functions.html#setTT_bijective">setTT_bijective</a></span>/= -[<span class="kwd">in</span> <span class="id">X</span> <span class="kwd">in</span> <span class="id"><a href="mathcomp.classical.functions.html#set_bij">set_bij</a></span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfkseries.X">X</a></span> <span class="id">_</span> -&gt; <span class="id">_</span>](@<span class="id"><a href="mathcomp.classical.classical_sets.html#setMTT">setMTT</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.esum.html#nneseries_esum">nneseries_esum</a></span>// <span class="id"><a href="mathcomp.classical.classical_sets.html#fun_true">fun_true</a></span>; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.esum.html#eq_esum">eq_esum</a></span>.<br/>
Qed.</div>
<br/>
<span class="id"><a name="HB_unnamed_factory_50">HB.instance</a></span> <span class="kwd">Definition</span> <span class="id">_</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.kernel.html#Build">Kernel_isSFinite_subdef.Build</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfkseries.R">R</a></span> (<span class="id"><a href="mathcomp.analysis.kernel.html#kseries">kseries</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfkseries.k">k</a></span>) <span class="id"><a href="mathcomp.analysis.kernel.html#sfkseries.sfinite_kseries">sfinite_kseries</a></span>.<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfkseries">sfkseries</a></span>.<br/>
<br/>
<span class="id"><a name="FiniteKernel_isSubProbability">HB.mixin</a></span> <span class="kwd">Record</span> <span class="id">FiniteKernel_isSubProbability</span> <span class="id">d</span> <span class="id">d</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span> : <span class="id">X</span> -&gt; {<span class="id">measure</span> <span class="id">set</span> <span class="id">Y</span> -&gt; \<span class="id">bar</span> <span class="id">R</span>}) := {<br/>
&nbsp;&nbsp;<span class="id">sprob_kernel</span> : <span class="id"><a href="mathcomp.analysis.ereal.html#ereal_sup">ereal_sup</a></span> [<span class="id">set</span> <span class="id">k</span> <span class="id">x</span> [<span class="id">set</span>: <span class="id">Y</span>] | <span class="id">x</span> <span class="kwd">in</span> [<span class="id">set</span>: <span class="id">X</span>]] &lt;= 1 }.<br/>
<br/>
#[<span class="id">short</span>(<span class="id">type</span>=<span class="id">sprobability_kernel</span>)]<br/>
<span class="id">HB.structure</span> <span class="kwd">Definition</span> <span class="id">SubProbabilityKernel</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d</span> <span class="id">d</span>' (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) :=<br/>
&nbsp;&nbsp;{ <span class="id">k</span> <span class="id">of</span> @<span class="id"><a href="mathcomp.analysis.kernel.html#FiniteKernel">FiniteKernel</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">k</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.kernel.html#FiniteKernel_isSubProbability">FiniteKernel_isSubProbability</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">R</span> <span class="id">k</span> }.<br/>
<span class="kwd">Notation</span> "<span class="id">R</span> .-<span class="id">spker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>" := (<span class="id"><a href="mathcomp.analysis.kernel.html#sprobability_kernel">sprobability_kernel</a></span> <span class="id">X</span>%<span class="id">type</span> <span class="id">Y</span> <span class="id">R</span>).<br/>
<br/>
<span class="id"><a name="Kernel_isSubProbability">HB.factory</a></span> <span class="kwd">Record</span> <span class="id">Kernel_isSubProbability</span> <span class="id">d</span> <span class="id">d</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span> : <span class="id">X</span> -&gt; {<span class="id">measure</span> <span class="id">set</span> <span class="id">Y</span> -&gt; \<span class="id">bar</span> <span class="id">R</span>}) <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.kernel.html#isKernel">isKernel</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">R</span> <span class="id">k</span> := {<br/>
&nbsp;&nbsp;<span class="id">sprob_kernel</span> : <span class="id"><a href="mathcomp.analysis.ereal.html#ereal_sup">ereal_sup</a></span> [<span class="id">set</span> <span class="id">k</span> <span class="id">x</span> [<span class="id">set</span>: <span class="id">Y</span>] | <span class="id">x</span> <span class="kwd">in</span> [<span class="id">set</span>: <span class="id">X</span>]] &lt;= 1 }.<br/>
<br/>
<span class="id"><a name="Builders_60">HB.builders</a></span> <span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>')<br/>
&nbsp;&nbsp;(<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) <span class="id">k</span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.kernel.html#Kernel_isSubProbability">Kernel_isSubProbability</a></span> <span class="id">d</span> <span class="id">d</span>' <span class="id">X</span> <span class="id">Y</span> <span class="id">R</span> <span class="id">k</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="Builders_60.Builders_60.finite">finite</a></span> : @<span class="id"><a href="mathcomp.analysis.kernel.html#Kernel_isFinite">Kernel_isFinite</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_60.Builders_60.d">d</a></span> <span class="id">d</span>' <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_60.Builders_60.X">X</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_60.Builders_60.Y">Y</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_60.Builders_60.R">R</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_60.Builders_60.k">k</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
<span class="id">split</span>; <span class="kwd">exists</span> 2%<span class="id">R</span> =&gt; /= ?; <span class="id">rewrite</span> (@<span class="id">le_lt_trans</span> <span class="id">_</span> <span class="id">_</span> 1%:<span class="id">E</span>) ?<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lte_fin">lte_fin</a></span> ?<span class="id">ltr1n</span>//.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">le_trans</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_60.sprob_kernel">sprob_kernel</a></span>)//; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.ereal.html#ereal_sup_ub">ereal_sup_ub</a></span>.<br/>
Qed.</div>
<br/>
<span class="id"><a name="Builders_60.HB_unnamed_factory_62">HB.instance</a></span> <span class="kwd">Definition</span> <span class="id">_</span> := <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_60.Builders_60.finite">finite</a></span>.<br/>
<br/>
<span class="id"><a name="Builders_60.HB_unnamed_factory_65">HB.instance</a></span> <span class="kwd">Definition</span> <span class="id">_</span> :=<br/>
&nbsp;&nbsp;@<span class="id"><a href="mathcomp.analysis.kernel.html#FiniteKernel_isSubProbability.Build">FiniteKernel_isSubProbability.Build</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_60.Builders_60.k">k</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_60.sprob_kernel">sprob_kernel</a></span>.<br/>
<br/>
<span class="id"><a href="mathcomp.analysis.kernel.html#Builders_60.Builders_60">HB.end</a></span>.<br/>
<br/>
<span class="id"><a name="SubProbability_isProbability">HB.mixin</a></span> <span class="kwd">Record</span> <span class="id">SubProbability_isProbability</span> <span class="id">d</span> <span class="id">d</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span> : <span class="id">X</span> -&gt; {<span class="id">measure</span> <span class="id">set</span> <span class="id">Y</span> -&gt; \<span class="id">bar</span> <span class="id">R</span>}) := {<br/>
&nbsp;&nbsp;<span class="id">prob_kernel</span> : <span class="kwd">forall</span> <span class="id">x</span>, <span class="id">k</span> <span class="id">x</span> [<span class="id">set</span>: <span class="id">Y</span>] = 1 }.<br/>
<br/>
#[<span class="id">short</span>(<span class="id">type</span>=<span class="id">probability_kernel</span>)]<br/>
<span class="id">HB.structure</span> <span class="kwd">Definition</span> <span class="id">ProbabilityKernel</span> <span class="id">d</span> <span class="id">d</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) :=<br/>
&nbsp;&nbsp;{ <span class="id">k</span> <span class="id">of</span> @<span class="id"><a href="mathcomp.analysis.kernel.html#SubProbabilityKernel">SubProbabilityKernel</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">k</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.kernel.html#SubProbability_isProbability">SubProbability_isProbability</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">R</span> <span class="id">k</span> }.<br/>
<span class="kwd">Notation</span> "<span class="id">R</span> .-<span class="id">pker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>" := (<span class="id"><a href="mathcomp.analysis.kernel.html#probability_kernel">probability_kernel</a></span> <span class="id">X</span>%<span class="id">type</span> <span class="id">Y</span> <span class="id">R</span>).<br/>
<br/>
<span class="id"><a name="Kernel_isProbability">HB.factory</a></span> <span class="kwd">Record</span> <span class="id">Kernel_isProbability</span> <span class="id">d</span> <span class="id">d</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span> : <span class="id">X</span> -&gt; {<span class="id">measure</span> <span class="id">set</span> <span class="id">Y</span> -&gt; \<span class="id">bar</span> <span class="id">R</span>}) <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.kernel.html#isKernel">isKernel</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">X</span> <span class="id">Y</span> <span class="id">R</span> <span class="id">k</span> := {<br/>
&nbsp;&nbsp;<span class="id">prob_kernel</span> : <span class="kwd">forall</span> <span class="id">x</span>, <span class="id">k</span> <span class="id">x</span> [<span class="id">set</span>: <span class="id">Y</span>] = 1 }.<br/>
<br/>
<span class="id"><a name="Builders_76">HB.builders</a></span> <span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>')<br/>
&nbsp;&nbsp;(<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) <span class="id">k</span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.kernel.html#Kernel_isProbability">Kernel_isProbability</a></span> <span class="id">d</span> <span class="id">d</span>' <span class="id">X</span> <span class="id">Y</span> <span class="id">R</span> <span class="id">k</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="Builders_76.Builders_76.sprob_kernel">sprob_kernel</a></span> : @<span class="id"><a href="mathcomp.analysis.kernel.html#Kernel_isSubProbability">Kernel_isSubProbability</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_76.Builders_76.d">d</a></span> <span class="id">d</span>' <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_76.Builders_76.X">X</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_76.Builders_76.Y">Y</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_76.Builders_76.R">R</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_76.Builders_76.k">k</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
<span class="kwd">by</span> <span class="id">split</span>; <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.ereal.html#ub_ereal_sup">ub_ereal_sup</a></span> =&gt; <span class="id">x</span> [<span class="id">y</span> <span class="id">_</span> &lt;-{<span class="id">x</span>}]; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_76.prob_kernel">prob_kernel</a></span>.<br/>
Qed.</div>
<br/>
<span class="id"><a name="Builders_76.HB_unnamed_factory_78">HB.instance</a></span> <span class="kwd">Definition</span> <span class="id">_</span> := <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_76.Builders_76.sprob_kernel">sprob_kernel</a></span>.<br/>
<br/>
<span class="id"><a name="Builders_76.HB_unnamed_factory_82">HB.instance</a></span> <span class="kwd">Definition</span> <span class="id">_</span> :=<br/>
&nbsp;&nbsp;@<span class="id"><a href="mathcomp.analysis.kernel.html#SubProbability_isProbability.Build">SubProbability_isProbability.Build</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_76.Builders_76.k">k</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#Builders_76.prob_kernel">prob_kernel</a></span>.<br/>
<br/>
<span class="id"><a href="mathcomp.analysis.kernel.html#Builders_76.Builders_76">HB.end</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="finite_kernel_measure">finite_kernel_measure</a></span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id">k</span> : <span class="id">R</span>.-<span class="id">fker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>) (<span class="id">x</span> : <span class="id">X</span>) :<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#fin_num_fun">fin_num_fun</a></span> (<span class="id">k</span> <span class="id">x</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
<span class="id">have</span> [<span class="id">r</span> <span class="id">k_r</span>] := <span class="id"><a href="mathcomp.analysis.kernel.html#measure_uub">measure_uub</a></span> <span class="id">k</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.measure.html#lty_fin_num_fun">lty_fin_num_fun</a></span>; <span class="id">rewrite</span> (@<span class="id">lt_trans</span> <span class="id">_</span> <span class="id">_</span> <span class="id">r</span>%:<span class="id">E</span>) ?<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#ltey">ltey</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="measurable_prod_subset_kernel">measurable_prod_subset_kernel</a></span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>).<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> <span class="id">A</span> : <span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> (<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.X">X</a></span> * <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.Y">Y</a></span>).<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="measurable_prod_subset_kernel.xsection_kernel">xsection_kernel</a></span>.<br/>
<span class="kwd">Variable</span> (<span class="id"><a name="measurable_prod_subset_kernel.xsection_kernel.k">k</a></span> : <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.R">R</a></span>.-<span class="id">ker</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.X">X</a></span> ~&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.Y">Y</a></span>) (<span class="id"><a name="measurable_prod_subset_kernel.xsection_kernel.D">D</a></span> : <span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.Y">Y</a></span>) (<span class="id"><a name="measurable_prod_subset_kernel.xsection_kernel.mD">mD</a></span> : <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id">D</span>).<br/>
<span class="kwd">Let</span> <span class="id"><a name="measurable_prod_subset_kernel.xsection_kernel.kD">kD</a></span> <span class="id">x</span> := <span class="id"><a href="mathcomp.analysis.measure.html#mrestr">mrestr</a></span> (<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel.k">k</a></span> <span class="id">x</span>) <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel.mD">mD</a></span>.<br/>
<span class="id"><a name="measurable_prod_subset_kernel.xsection_kernel.hb_instance_84">HB.instance</a></span> <span class="kwd">Definition</span> <span class="id">_</span> <span class="id">x</span> := <span class="id"><a href="mathcomp.analysis.measure.html#Measure.on">Measure.on</a></span> (<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel.kD">kD</a></span> <span class="id">x</span>).<br/>
<span class="kwd">Let</span> <span class="id"><a name="measurable_prod_subset_kernel.xsection_kernel.phi">phi</a></span> <span class="id">A</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel.kD">kD</a></span> <span class="id">x</span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#xsection">xsection</a></span> <span class="id">A</span> <span class="id">x</span>).<br/>
<span class="kwd">Let</span> <span class="id"><a name="measurable_prod_subset_kernel.xsection_kernel.XY">XY</a></span> := [<span class="id">set</span> <span class="id">A</span> | <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id">A</span> /\ <span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> [<span class="id">set</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.X">X</a></span>] (<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel.phi">phi</a></span> <span class="id">A</span>)].<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="measurable_prod_subset_kernel.xsection_kernel.phiM">phiM</a></span> (<span class="id">A</span> : <span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.X">X</a></span>) <span class="id">B</span> : <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel.phi">phi</a></span> (<span class="id">A</span> `*` <span class="id">B</span>) = (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel.kD">kD</a></span> <span class="id">x</span> <span class="id">B</span> * (\1<span class="id">_A</span> <span class="id">x</span>)%:<span class="id">E</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.boolp.html#funeqE">funeqE</a></span> =&gt; <span class="id">x</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.numfun.html#indicE">indicE</a></span> /<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel.phi">phi</a></span>/=.<br/>
<span class="id">have</span> [<span class="id">xA</span>|<span class="id">xA</span>] := <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#boolP">boolP</a></span> (<span class="id">x</span> \<span class="kwd">in</span> <span class="id">A</span>); <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule1">mule1</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#in_xsectionM">in_xsectionM</a></span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule0">mule0</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#notin_xsectionM">notin_xsectionM</a></span>// <span class="id"><a href="mathcomp.classical.classical_sets.html#set0I">set0I</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#measure0">measure0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="measurable_prod_subset_xsection_kernel">measurable_prod_subset_xsection_kernel</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span>, <span class="kwd">exists</span> <span class="id">M</span>, <span class="kwd">forall</span> <span class="id">X</span>, <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id">X</span> -&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel.kD">kD</a></span> <span class="id">x</span> <span class="id">X</span> &lt; <span class="id">M</span>%:<span class="id">E</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> `&lt;=` <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel.XY">XY</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
<span class="id">move</span>=&gt; <span class="id">kD_ub</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable_prod_measurableType">measurable_prod_measurableType</a></span>.<br/>
<span class="id">set</span> <span class="id">C</span> := [<span class="id">set</span> <span class="id">A</span> `*` <span class="id">B</span> | <span class="id">A</span> <span class="kwd">in</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> &amp; <span class="id">B</span> <span class="kwd">in</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span>].<br/>
<span class="id">have</span> <span class="id">CI</span> : <span class="id"><a href="mathcomp.analysis.measure.html#setI_closed">setI_closed</a></span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">_</span> <span class="id">_</span> [<span class="id">X1</span> <span class="id">mX1</span> [<span class="id">X2</span> <span class="id">mX2</span> &lt;-]] [<span class="id">Y1</span> <span class="id">mY1</span> [<span class="id">Y2</span> <span class="id">mY2</span> &lt;-]].<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">X1</span> `&amp;` <span class="id">Y1</span>); <span class="id">first</span> <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.measure.html#measurableI">measurableI</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="kwd">exists</span> (<span class="id">X2</span> `&amp;` <span class="id">Y2</span>); [<span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.measure.html#measurableI">measurableI</a></span>|<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setMI">setMI</a></span>].<br/>
<span class="id">have</span> <span class="id">CT</span> : <span class="id">C</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> <span class="kwd">by</span> <span class="kwd">exists</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> =&gt; //; <span class="kwd">exists</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> =&gt; //; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setMTT">setMTT</a></span>.<br/>
<span class="id">have</span> <span class="id">CXY</span> : <span class="id">C</span> `&lt;=` <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel.XY">XY</a></span>.<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">_</span> [<span class="id">A</span> <span class="id">mA</span> [<span class="id">B</span> <span class="id">mB</span> &lt;-]]; <span class="id">split</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.measure.html#measurableM">measurableM</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel.phiM">phiM</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#emeasurable_funM">emeasurable_funM</a></span> =&gt; //; <span class="id">first</span> <span class="id">exact</span>/<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_kernel">measurable_kernel</a></span>/<span class="id"><a href="mathcomp.analysis.measure.html#measurableI">measurableI</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#EFin_measurable_fun">EFin_measurable_fun</a></span>; <span class="id">rewrite</span> (<span class="id">_</span> : \1<span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#mindic">mindic</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.R">R</a></span> <span class="id">mA</span>).<br/>
<span class="id">suff</span> <span class="id">monoB</span> : <span class="id"><a href="mathcomp.analysis.measure.html#monotone_class">monotone_class</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel.XY">XY</a></span> <span class="kwd">by</span> <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.measure.html#monotone_class_subset">monotone_class_subset</a></span>.<br/>
<span class="id">split</span> =&gt; //; [<span class="id">exact</span>: <span class="id">CXY</span>| |<span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#xsection_ndseq_closed">xsection_ndseq_closed</a></span>].<br/>
<span class="id">move</span>=&gt; <span class="id">A</span> <span class="id">B</span> <span class="id">BA</span> [<span class="id">mA</span> <span class="id">mphiA</span>] [<span class="id">mB</span> <span class="id">mphiB</span>]; <span class="id">split</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.measure.html#measurableD">measurableD</a></span>.<br/>
<span class="id">suff</span> : <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel.phi">phi</a></span> (<span class="id">A</span> `\` <span class="id">B</span>) = (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel.phi">phi</a></span> <span class="id">A</span> <span class="id">x</span> - <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel.phi">phi</a></span> <span class="id">B</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; -&gt;; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#emeasurable_funB">emeasurable_funB</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.boolp.html#funeqE">funeqE</a></span> =&gt; <span class="id">x</span>; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel.phi">phi</a></span>/= <span class="id"><a href="mathcomp.classical.classical_sets.html#xsectionD">xsectionD</a></span>// <span class="id"><a href="mathcomp.analysis.measure.html#measureD">measureD</a></span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setIidr">setIidr</a></span>//; <span class="id">exact</span>: <span class="id"><a href="mathcomp.classical.classical_sets.html#le_xsection">le_xsection</a></span>.<br/>
- <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#measurable_xsection">measurable_xsection</a></span>.<br/>
- <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#measurable_xsection">measurable_xsection</a></span>.<br/>
- <span class="id">have</span> [<span class="id">M</span> <span class="id">kM</span>] := <span class="id">kD_ub</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">lt_le_trans</span> (<span class="id">kM</span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#xsection">xsection</a></span> <span class="id">A</span> <span class="id">x</span>) <span class="id">_</span>)) ?<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#leey">leey</a></span>//.<br/>
&nbsp;&nbsp;<span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#measurable_xsection">measurable_xsection</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel.xsection_kernel">xsection_kernel</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_kernel">measurable_prod_subset_kernel</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="measurable_fun_xsection_finite_kernel">measurable_fun_xsection_finite_kernel</a></span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>).<br/>
<span class="kwd">Variable</span> <span class="id"><a name="measurable_fun_xsection_finite_kernel.k">k</a></span> : <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_xsection_finite_kernel.R">R</a></span>.-<span class="id">fker</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_xsection_finite_kernel.X">X</a></span> ~&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_xsection_finite_kernel.Y">Y</a></span>.<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> <span class="id">A</span> : <span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> (<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_xsection_finite_kernel.X">X</a></span> * <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_xsection_finite_kernel.Y">Y</a></span>).<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="measurable_fun_xsection_finite_kernel.phi">phi</a></span> <span class="id">A</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_xsection_finite_kernel.k">k</a></span> <span class="id">x</span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#xsection">xsection</a></span> <span class="id">A</span> <span class="id">x</span>).<br/>
<span class="kwd">Let</span> <span class="id"><a name="measurable_fun_xsection_finite_kernel.XY">XY</a></span> := [<span class="id">set</span> <span class="id">A</span> | <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id">A</span> /\ <span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> [<span class="id">set</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_xsection_finite_kernel.X">X</a></span>] (<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_xsection_finite_kernel.phi">phi</a></span> <span class="id">A</span>)].<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="measurable_fun_xsection_finite_kernel">measurable_fun_xsection_finite_kernel</a></span> <span class="id">A</span> :<br/>
&nbsp;&nbsp;<span class="id">A</span> \<span class="kwd">in</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> -&gt; <span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> [<span class="id">set</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_xsection_finite_kernel.X">X</a></span>] (<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_xsection_finite_kernel.phi">phi</a></span> <span class="id">A</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
<span class="id">move</span>: <span class="id">A</span>; <span class="id">suff</span> : <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> `&lt;=` <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_xsection_finite_kernel.XY">XY</a></span> <span class="kwd">by</span> <span class="id">move</span>=&gt; + <span class="id">A</span>; <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE</a></span> =&gt; /[<span class="id">apply</span>] -[].<br/>
<span class="id">move</span>=&gt; /= <span class="id">A</span> <span class="id">mA</span>; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_xsection_finite_kernel.XY">XY</a></span>/=; <span class="id">split</span> =&gt; //; <span class="id">rewrite</span> (<span class="id">_</span> : <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_xsection_finite_kernel.phi">phi</a></span> <span class="id">_</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="mathcomp.analysis.measure.html#mrestr">mrestr</a></span> (<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_xsection_finite_kernel.k">k</a></span> <span class="id">x</span>) <span class="id"><a href="mathcomp.analysis.measure.html#measurableT">measurableT</a></span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#xsection">xsection</a></span> <span class="id">A</span> <span class="id">x</span>))); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> =&gt; <span class="id">x</span>//=; <span class="id">rewrite</span> /<span class="id"><a href="mathcomp.analysis.measure.html#mrestr">mrestr</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setIT">setIT</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_prod_subset_xsection_kernel">measurable_prod_subset_xsection_kernel</a></span> =&gt; // <span class="id">x</span>.<br/>
<span class="id">have</span> [<span class="id">r</span> <span class="id">hr</span>] := <span class="id"><a href="mathcomp.analysis.kernel.html#measure_uub">measure_uub</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_xsection_finite_kernel.k">k</a></span>; <span class="kwd">exists</span> <span class="id">r</span> =&gt; <span class="id">B</span> <span class="id">mB</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">le_lt_trans</span> <span class="id">_</span> (<span class="id">hr</span> <span class="id">x</span>)) // /<span class="id"><a href="mathcomp.analysis.measure.html#mrestr">mrestr</a></span> /= <span class="id"><a href="mathcomp.classical.classical_sets.html#setIT">setIT</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#le_measure">le_measure</a></span>// <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_xsection_finite_kernel">measurable_fun_xsection_finite_kernel</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="measurable_fun_integral_finite_sfinite">measurable_fun_integral_finite_sfinite</a></span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id">X</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>) (<span class="id">Y</span> : <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">d</span>') (<span class="id">R</span> : <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>).<br/>
<span class="kwd">Variable</span> <span class="id"><a name="measurable_fun_integral_finite_sfinite.k">k</a></span> : <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.X">X</a></span> * <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.Y">Y</a></span> -&gt; \<span class="id">bar</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.R">R</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="measurable_fun_xsection_integral">measurable_fun_xsection_integral</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.X">X</a></span> -&gt; {<span class="id">measure</span> <span class="id">set</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.Y">Y</a></span> -&gt; \<span class="id">bar</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.R">R</a></span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k_</span> : ({<span class="id">nnsfun</span> [<span class="id">the</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id">_</span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.X">X</a></span> * <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.Y">Y</a></span>] &gt;-&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.R">R</a></span>})^<span class="id">nat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ndk_</span> : <span class="id">nondecreasing_seq</span> (<span class="id">k_</span> : (<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.X">X</a></span> * <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.Y">Y</a></span> -&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.R">R</a></span>)^<span class="id">nat</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k_k</span> : <span class="kwd">forall</span> <span class="id">z</span>, <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> \<span class="id">o</span> (<span class="id">k_</span> ^~ <span class="id">z</span>) --&gt; <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.k">k</a></span> <span class="id">z</span>) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> [<span class="id">set</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.X">X</a></span>] (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">l</span> <span class="id">x</span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#xsection">xsection</a></span> (<span class="id">k_</span> <span class="id">n</span> @^-1` [<span class="id">set</span> <span class="id">r</span>]) <span class="id">x</span>))) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> [<span class="id">set</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.X">X</a></span>] (<span class="kwd">fun</span> <span class="id">x</span> =&gt; \<span class="id">int</span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">_y</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.k">k</a></span> (<span class="id">x</span>, <span class="id">y</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
<span class="id">move</span>=&gt; <span class="id">h</span>.<br/>
<span class="id">rewrite</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">_</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="mathcomp.analysis.sequences.html#lim_esup">limn_esup</a></span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; \<span class="id">int</span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">_y</span> (<span class="id">k_</span> <span class="id">n</span> (<span class="id">x</span>, <span class="id">y</span>))%:<span class="id">E</span>))); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">transitivity</span> (<span class="id">lim</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; \<span class="id">int</span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">_y</span> (<span class="id">k_</span> <span class="id">n</span> (<span class="id">x</span>, <span class="id">y</span>))%:<span class="id">E</span>)); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">is_cvg_limn_esupE</span>//.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">ereal_nondecreasing_is_cvgn</span> =&gt; <span class="id">m</span> <span class="id">n</span> <span class="id">mn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">ge0_le_integral</span> =&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">y</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exact</span>/<span class="id">EFin_measurable_fun</span>/<span class="id">measurableT_comp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">y</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exact</span>/<span class="id">EFin_measurable_fun</span>/<span class="id">measurableT_comp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">y</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>; <span class="id">exact</span>/<span class="id">lefP</span>/<span class="id">ndk_</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -<span class="id">monotone_convergence</span>//.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">eq_integral</span> =&gt; <span class="id">y</span> <span class="id">_</span>; <span class="id">apply</span>/<span class="id">esym</span>/<span class="id">cvg_lim</span> =&gt; //; <span class="id">exact</span>: <span class="id">k_k</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">n</span>; <span class="id">exact</span>/<span class="id">EFin_measurable_fun</span>/<span class="id">measurableT_comp</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">n</span> <span class="id">y</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">y</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">mn</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>; <span class="id">exact</span>/<span class="id">lefP</span>/<span class="id">ndk_</span>.<br/>
<span class="id">apply</span>: <span class="id">measurable_fun_limn_esup</span> =&gt; <span class="id">n</span>.<br/>
<span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">measurable_fun</span> <span class="id">_</span> <span class="id">X</span>](<span class="id">_</span> : <span class="id">_</span> = (<span class="kwd">fun</span> <span class="id">x</span> =&gt; \<span class="id">int</span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">_y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(\<span class="id">sum_</span>(<span class="id">r</span> \<span class="kwd">in</span> <span class="id">range</span> (<span class="id">k_</span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">r</span> * \1<span class="id">_</span>(<span class="id">k_</span> <span class="id">n</span> @^-1` [<span class="id">set</span> <span class="id">r</span>]) (<span class="id">x</span>, <span class="id">y</span>))%:<span class="id">E</span>)); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">x</span>; <span class="id">apply</span>: <span class="id">eq_integral</span> =&gt; <span class="id">y</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">fimfunE</span>.<br/>
<span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">measurable_fun</span> <span class="id">_</span> <span class="id">X</span>](<span class="id">_</span> : <span class="id">_</span> = (<span class="kwd">fun</span> <span class="id">x</span> =&gt; \<span class="id">sum_</span>(<span class="id">r</span> \<span class="kwd">in</span> <span class="id">range</span> (<span class="id">k_</span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(\<span class="id">int</span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">_y</span> (<span class="id">r</span> * \1<span class="id">_</span>(<span class="id">k_</span> <span class="id">n</span> @^-1` [<span class="id">set</span> <span class="id">r</span>]) (<span class="id">x</span>, <span class="id">y</span>))%:<span class="id">E</span>))); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">x</span>; <span class="id">rewrite</span> -<span class="id">ge0_integral_fsum</span>//.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">eq_integral</span> =&gt; <span class="id">y</span> <span class="id">_</span>; <span class="id">rewrite</span> -<span class="id">fsumEFin</span>.<br/>
&nbsp;&nbsp;- <span class="id">move</span>=&gt; <span class="id">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">EFin_measurable_fun</span>/<span class="id">measurableT_comp</span> =&gt; [//|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>/<span class="id">measurableT_comp</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">m</span> <span class="id">y</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">nnfun_muleindic_ge0</span>.<br/>
<span class="id">apply</span>: <span class="id">emeasurable_fun_fsum</span> =&gt; // <span class="id">r</span>.<br/>
<span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">measurable_fun</span> <span class="id">_</span> <span class="id">X</span>](<span class="id">_</span> : <span class="id">_</span> = (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">r</span>%:<span class="id">E</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;\<span class="id">int</span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">_y</span> (\1<span class="id">_</span>(<span class="id">k_</span> <span class="id">n</span> @^-1` [<span class="id">set</span> <span class="id">r</span>]) (<span class="id">x</span>, <span class="id">y</span>))%:<span class="id">E</span>)); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">x</span>; <span class="id">under</span> <span class="id">eq_integral</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">EFinM</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> [<span class="id">r0</span>|<span class="id">r0</span>] := <span class="id">leP</span> 0%<span class="id">R</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">ge0_integralZl</span>//; <span class="id">last</span> <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">y</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>/<span class="id">EFin_measurable_fun</span>/<span class="id">measurableT_comp</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">integral0_eq</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">y</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">preimage_nnfun0</span>// <span class="id">indic0</span> <span class="id">mule0</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">integral0_eq</span> ?<span class="id">mule0</span>// =&gt; <span class="id">y</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">preimage_nnfun0</span>// <span class="id">indic0</span>.<br/>
<span class="id">apply</span>/<span class="id">measurable_funeM</span>.<br/>
<span class="id">rewrite</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">_</span>) = (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">l</span> <span class="id">x</span> (<span class="id">xsection</span> (<span class="id">k_</span> <span class="id">n</span> @^-1` [<span class="id">set</span> <span class="id">r</span>]) <span class="id">x</span>))).<br/>
&nbsp;&nbsp;<span class="id">exact</span>/<span class="id">h</span>.<br/>
<span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">x</span>; <span class="id">rewrite</span> <span class="id">integral_indic</span>//; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">_</span>) = <span class="id">xsection</span> (<span class="id">k_</span> <span class="id">n</span> @^-1` [<span class="id">set</span> <span class="id">r</span>]) <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">measurable_xsection</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">xsection</span>; <span class="id">apply</span>/<span class="id">seteqP</span>; <span class="id">split</span>=&gt; <span class="id">y</span>/= /[!<span class="id">inE</span>].<br/>
<span class="id">congr</span> (<span class="id">l</span> <span class="id">x</span> <span class="id">_</span>); <span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">y1</span>/=; <span class="id">rewrite</span> /<span class="id">xsection</span>/= <span class="id">inE</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">propext</span>; <span class="id">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">measurable_fun_integral_finite_kernel</span> (<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.R">l</a></span> : <span class="id">R</span>.-<span class="id">fker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k0</span> : <span class="kwd">forall</span> <span class="id">z</span>, 0 &lt;= <span class="id">k</span> <span class="id">z</span>) (<span class="id">mk</span> : <span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.Y">X</a></span> * <span class="id">Y</span>] <span class="id">k</span>) :<br/>
&nbsp;&nbsp;<span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id">X</span>] (<span class="kwd">fun</span> <span class="id">x</span> =&gt; \<span class="id">int</span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">_y</span> <span class="id">k</span> (<span class="id">x</span>, <span class="id">y</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
<span class="id">have</span> [<span class="id">k_</span> [<span class="id">ndk_</span> <span class="id">k_k</span>]] := <span class="id">approximation</span> <span class="id">measurableT</span> <span class="id">mk</span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">_</span> =&gt; <span class="id">k0</span> <span class="id">x</span>).<br/>
<span class="id">apply</span>: (<span class="id">measurable_fun_xsection_integral</span> <span class="id">ndk_</span> (<span class="id">k_k</span> ^~ <span class="id">Logic.I</span>)) =&gt; <span class="id">n</span> <span class="id">r</span>.<br/>
<span class="id">have</span> [<span class="id">l_</span> <span class="id">hl_</span>] := <span class="id">measure_uub</span> <span class="id">l</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">measurable_fun_xsection_finite_kernel</span> =&gt; // /[!<span class="id">inE</span>].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">measurable_fun_integral_sfinite_kernel</span> (<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.R">l</a></span> : <span class="id">R</span>.-<span class="id">sfker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k0</span> : <span class="kwd">forall</span> <span class="id">t</span>, 0 &lt;= <span class="id">k</span> <span class="id">t</span>) (<span class="id">mk</span> : <span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_integral_finite_sfinite.Y">X</a></span> * <span class="id">Y</span>] <span class="id">k</span>) :<br/>
&nbsp;&nbsp;<span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id">X</span>] (<span class="kwd">fun</span> <span class="id">x</span> =&gt; \<span class="id">int</span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">_y</span> <span class="id">k</span> (<span class="id">x</span>, <span class="id">y</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
<span class="id">have</span> [<span class="id">k_</span> [<span class="id">ndk_</span> <span class="id">k_k</span>]] := <span class="id">approximation</span> <span class="id">measurableT</span> <span class="id">mk</span> (<span class="kwd">fun</span> <span class="id">xy</span> <span class="id">_</span> =&gt; <span class="id">k0</span> <span class="id">xy</span>).<br/>
<span class="id">apply</span>: (<span class="id">measurable_fun_xsection_integral</span> <span class="id">ndk_</span> (<span class="id">k_k</span> ^~ <span class="id">Logic.I</span>)) =&gt; <span class="id">n</span> <span class="id">r</span>.<br/>
<span class="id">have</span> [<span class="id">l_</span> <span class="id">hl_</span>] := <span class="id">sfinite_kernel</span> <span class="id">l</span>.<br/>
<span class="id">rewrite</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">_</span>) = (<span class="kwd">fun</span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mseries</span> (<span class="id">l_</span> ^~ <span class="id">x</span>) 0 (<span class="id">xsection</span> (<span class="id">k_</span> <span class="id">n</span> @^-1` [<span class="id">set</span> <span class="id">r</span>]) <span class="id">x</span>))); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">x</span>; <span class="id">rewrite</span> <span class="id">hl_</span>//; <span class="id">exact</span>/<span class="id">measurable_xsection</span>.<br/>
<span class="id">apply</span>: <span class="id">ge0_emeasurable_fun_sum</span> =&gt; // <span class="id">m</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">measurable_fun_xsection_finite_kernel</span> =&gt; // /[!<span class="id">inE</span>].<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">measurable_fun_integral_finite_sfinite</span>.<br/>
<span class="kwd">Arguments</span> <span class="id">measurable_fun_xsection_integral</span> {<span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>} <span class="id">k</span> <span class="id">l</span>.<br/>
<span class="kwd">Arguments</span> <span class="id">measurable_fun_integral_finite_kernel</span> {<span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>} <span class="id">k</span> <span class="id">l</span>.<br/>
<span class="kwd">Arguments</span> <span class="id">measurable_fun_integral_sfinite_kernel</span> {<span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>} <span class="id">k</span> <span class="id">l</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">kdirac</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">X</a></span> : <span class="id">measurableType</span> <span class="id">d</span>) (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Y</a></span> : <span class="id">measurableType</span> <span class="id">d</span>') (<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">R</a></span> : <span class="id">realType</span>).<br/>
<span class="kwd">Variable</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kdirac.X">f</a></span> : <span class="id">X</span> -&gt; <span class="id">Y</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">kdirac</span> (<span class="id">mf</span> : <span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id">X</span>] <span class="id">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id">X</span> -&gt; {<span class="id">measure</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kdirac.Y">set</a></span> <span class="id">Y</span> -&gt; \<span class="id"><a href="mathcomp.analysis.kernel.html#kdirac.R">bar</a></span> <span class="id">R</span>} :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">x</span> =&gt; [<span class="id"><a href="mathcomp.analysis.measure.html#Measure.Exports.measure">the</a></span> <span class="id">measure</span> <span class="id">_</span> <span class="id">_</span> <span class="id">of</span> <span class="id">dirac</span> (<span class="id">f</span> <span class="id">x</span>)].<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id">mf</span> : <span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id">X</span>] <span class="id">f</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">measurable_fun_kdirac</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable">U</a></span> : <span class="id">measurable</span> <span class="id">U</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#kdirac">X</a></span>] (<span class="id">kdirac</span> <span class="id">mf</span> ^~ <span class="id">U</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
<span class="id">move</span>=&gt; <span class="id">mU</span>; <span class="id">apply</span>/<span class="id">EFin_measurable_fun</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">_</span>) = <span class="id">mindic</span> <span class="id">R</span> <span class="id">mU</span> \<span class="id">o</span> <span class="id">f</span>)//; <span class="id">exact</span>/<span class="id">measurableT_comp</span>.<br/>
Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="kwd">Definition</span> <span class="id">_</span> := <span class="id">isKernel.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">kdirac</span> <span class="id">mf</span>)<br/>
&nbsp;&nbsp;<span class="id">measurable_fun_kdirac</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">kdirac_prob</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kdirac">x</a></span> : <span class="id">kdirac</span> <span class="id">mf</span> <span class="id">x</span> <span class="id">setT</span> = 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">kdirac</span>/= <span class="id">diracT</span>. Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="kwd">Definition</span> <span class="id">_</span> := <span class="id">Kernel_isProbability.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span><br/>
&nbsp;&nbsp;(<span class="id">kdirac</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kdirac.kdirac_prob">mf</a></span>) <span class="id">kdirac_prob</span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id">kdirac</span>.<br/>
<span class="kwd">Arguments</span> <span class="id">kdirac</span> {<span class="id">d</span> <span class="id">d</span>' <span class="id">X</span> <span class="id">Y</span> <span class="id">R</span> <span class="id">f</span>}.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">dist_salgebra_instance</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">T</a></span> : <span class="id">measurableType</span> <span class="id">d</span>) (<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">R</a></span> : <span class="id">realType</span>).<br/>
<br/>
<span class="kwd">Let</span> <span class="id">p0</span> : <span class="id">probability</span> <span class="id">T</span> <span class="id">R</span> := [<span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">the</a></span> <span class="id">probability</span> <span class="id">_</span> <span class="id">_</span> <span class="id">of</span> <span class="id">dirac</span> <span class="id">point</span>].<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">prob_pointed</span> := <span class="id">Pointed.Class</span><br/>
&nbsp;&nbsp;(<span class="id">Choice.Class</span> <span class="id">gen_eqMixin</span> (<span class="id">Choice.Class</span> <span class="id">gen_eqMixin</span> <span class="id">gen_choiceMixin</span>)) <span class="id">p0</span>.<br/>
<br/>
<span class="kwd">Canonical</span> <span class="id">probability_eqType</span> := <span class="id">EqType</span> (<span class="id">probability</span> <span class="id">T</span> <span class="id">R</span>) <span class="id">prob_pointed</span>.<br/>
<span class="kwd">Canonical</span> <span class="id">probability_choiceType</span> := <span class="id">ChoiceType</span> (<span class="id">probability</span> <span class="id">T</span> <span class="id">R</span>) <span class="id">prob_pointed</span>.<br/>
<span class="kwd">Canonical</span> <span class="id">probability_ptType</span> := <span class="id">PointedType</span> (<span class="id">probability</span> <span class="id">T</span> <span class="id">R</span>) <span class="id">prob_pointed</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">mset</span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#set">U</a></span> : <span class="id"><a href="mathcomp.analysis.kernel.html#dist_salgebra_instance.T">set</a></span> <span class="id">T</span>) (<span class="id"><a href="mathcomp.analysis.kernel.html#dist_salgebra_instance.R">r</a></span> : <span class="id">R</span>) := [<span class="id">set</span> <span class="id">mu</span> : <span class="id">probability</span> <span class="id">T</span> <span class="id">R</span> | <span class="id">mu</span> <span class="id">U</span> &lt; <span class="id">r</span>%:<span class="id">E</span>].<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">lt0_mset</span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#set">U</a></span> : <span class="id"><a href="mathcomp.analysis.kernel.html#dist_salgebra_instance.T">set</a></span> <span class="id">T</span>) (<span class="id"><a href="mathcomp.analysis.kernel.html#dist_salgebra_instance.R">r</a></span> : <span class="id">R</span>) : (<span class="id">r</span> &lt; 0)%<span class="id">R</span> -&gt; <span class="id">mset</span> <span class="id">U</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set0">r</a></span> = <span class="id">set0</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
<span class="id">move</span>=&gt; <span class="id">r0</span>; <span class="id">apply</span>/<span class="id">seteqP</span>; <span class="id">split</span> =&gt; // <span class="id">x</span>/=.<br/>
<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">negP</span>; <span class="id">rewrite</span> -<span class="id">leNgt</span> (@<span class="id">le_trans</span> <span class="id">_</span> <span class="id">_</span> 0)// <span class="id">lee_fin</span> <span class="id">ltW</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">gt1_mset</span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#set">U</a></span> : <span class="id"><a href="mathcomp.analysis.kernel.html#dist_salgebra_instance.T">set</a></span> <span class="id">T</span>) (<span class="id"><a href="mathcomp.analysis.kernel.html#dist_salgebra_instance.R">r</a></span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">measurable</span> <span class="id">U</span> -&gt; (1 &lt; <span class="id">r</span>)%<span class="id">R</span> -&gt; <span class="id">mset</span> <span class="id">U</span> <span class="id">r</span> = [<span class="id">set</span>: <span class="id">probability</span> <span class="id">T</span> <span class="id">R</span>].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
<span class="id">move</span>=&gt; <span class="id">mU</span> <span class="id">r1</span>; <span class="id">apply</span>/<span class="id">seteqP</span>; <span class="id">split</span> =&gt; // <span class="id">x</span>/= <span class="id">_</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">mset</span>/= (<span class="id">le_lt_trans</span> (<span class="id">probability_le1</span> <span class="id">_</span> <span class="id">_</span>)).<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id">pset</span> : <span class="id">set</span> (<span class="id">set</span> (<span class="id">probability</span> <span class="id">T</span> <span class="id">R</span>)) :=<br/>
&nbsp;&nbsp;[<span class="id"><a href="mathcomp.analysis.kernel.html#mset">set</a></span> <span class="id">mset</span> <span class="id">U</span> <span class="id">r</span> | <span class="id">r</span> <span class="kwd">in</span> `[0%<span class="id">R</span>,1%<span class="id">R</span>] &amp; <span class="id">U</span> <span class="kwd">in</span> <span class="id">measurable</span>].<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">pprobability</span> : <span class="id">measurableType</span> <span class="id">pset</span>.-<span class="id">sigma</span> :=<br/>
&nbsp;&nbsp;[<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">the</a></span> <span class="id">measurableType</span> <span class="id">_</span> <span class="id">of</span> <span class="id">salgebraType</span> <span class="id">pset</span>].<br/>
<br/>
<span class="kwd">End</span> <span class="id">dist_salgebra_instance</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">kprobability</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">X</a></span> : <span class="id">measurableType</span> <span class="id">d</span>) (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Y</a></span> : <span class="id">measurableType</span> <span class="id">d</span>') (<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">R</a></span> : <span class="id">realType</span>).<br/>
<span class="kwd">Variable</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kprobability.X">P</a></span> : <span class="id">X</span> -&gt; <span class="id">pprobability</span> <span class="id">Y</span> <span class="id">R</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">kprobability</span> (<span class="id">mP</span> : <span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id">X</span>] <span class="id">P</span>)<br/>
&nbsp;&nbsp;: <span class="id">X</span> -&gt; {<span class="id">measure</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kprobability.Y">set</a></span> <span class="id">Y</span> -&gt; \<span class="id"><a href="mathcomp.analysis.kernel.html#kprobability.R">bar</a></span> <span class="id">R</span>} := <span class="id">P</span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id">mP</span> : <span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id">X</span>] <span class="id">P</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">measurable_fun_kprobability</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable">U</a></span> : <span class="id">measurable</span> <span class="id">U</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#kprobability">X</a></span>] (<span class="id">kprobability</span> <span class="id">mP</span> ^~ <span class="id">U</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
<span class="id">move</span>=&gt; <span class="id">mU</span>.<br/>
<span class="id">apply</span>: (<span class="id">measurability</span> (<span class="id">ErealGenInftyO.measurableE</span> <span class="id">R</span>)) =&gt; <span class="id">_</span> /= -[<span class="id">_</span> [<span class="id">r</span> -&gt;] &lt;-].<br/>
<span class="id">rewrite</span> <span class="id">setTI</span> <span class="id">preimage_itv_infty_o</span> -/(<span class="id">P</span> @^-1` <span class="id">mset</span> <span class="id">U</span> <span class="id">r</span>).<br/>
<span class="id">have</span> [<span class="id">r0</span>|<span class="id">r0</span>] := <span class="id">leP</span> 0%<span class="id">R</span> <span class="id">r</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lt0_mset</span>// <span class="id">preimage_set0</span>.<br/>
<span class="id">have</span> [<span class="id">r1</span>|<span class="id">r1</span>] := <span class="id">leP</span> <span class="id">r</span> 1%<span class="id">R</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">gt1_mset</span>// <span class="id">preimage_setT</span>.<br/>
<span class="id">move</span>: <span class="id">mP</span> =&gt; /(<span class="id">_</span> <span class="id">measurableT</span> (<span class="id">mset</span> <span class="id">U</span> <span class="id">r</span>)); <span class="id">rewrite</span> <span class="id">setTI</span>; <span class="id">apply</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">sub_sigma_algebra</span>; <span class="kwd">exists</span> <span class="id">r</span> =&gt; /=; [<span class="id">rewrite</span> <span class="id">in_itv</span>/= <span class="id">r0</span>|<span class="kwd">exists</span> <span class="id">U</span>].<br/>
Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="kwd">Definition</span> <span class="id">_</span> :=<br/>
&nbsp;&nbsp;@<span class="id">isKernel.Build</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kprobability.X">_</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#kprobability.Y">_</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#kprobability.R">X</a></span> <span class="id">Y</span> <span class="id">R</span> (<span class="id">kprobability</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kprobability.measurable_fun_kprobability">mP</a></span>) <span class="id">measurable_fun_kprobability</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">kprobability_prob</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kprobability">x</a></span> : <span class="id">kprobability</span> <span class="id">mP</span> <span class="id">x</span> [<span class="id">set</span>: <span class="id">Y</span>] = 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">kprobability</span>/= <span class="id">probability_setT</span>. Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="kwd">Definition</span> <span class="id">_</span> :=<br/>
&nbsp;&nbsp;@<span class="id">Kernel_isProbability.Build</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kprobability.X">_</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#kprobability.Y">_</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#kprobability.R">X</a></span> <span class="id">Y</span> <span class="id">R</span> (<span class="id">kprobability</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kprobability.kprobability_prob">mP</a></span>) <span class="id">kprobability_prob</span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id">kprobability</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">kadd</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">X</a></span> : <span class="id">measurableType</span> <span class="id">d</span>) (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Y</a></span> : <span class="id">measurableType</span> <span class="id">d</span>') (<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">R</a></span> : <span class="id">realType</span>).<br/>
<span class="kwd">Variables</span> <span class="id">k1</span> <span class="id">k2</span> : <span class="id">R</span>.-<span class="id"><a href="mathcomp.analysis.kernel.html#kadd.X">ker</a></span> <span class="id">X</span> ~&gt; <span class="id">Y</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">kadd</span> : <span class="id">X</span> -&gt; {<span class="id">measure</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kadd.Y">set</a></span> <span class="id">Y</span> -&gt; \<span class="id"><a href="mathcomp.analysis.kernel.html#kadd.R">bar</a></span> <span class="id">R</span>} :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">x</span> =&gt; [<span class="id"><a href="mathcomp.analysis.measure.html#Measure.Exports.measure">the</a></span> <span class="id">measure</span> <span class="id">_</span> <span class="id">_</span> <span class="id">of</span> <span class="id">measure_add</span> (<span class="id">k1</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kadd.k2">x</a></span>) (<span class="id">k2</span> <span class="id">x</span>)].<br/>
<br/>
<span class="kwd">Let</span> <span class="id">measurable_fun_kadd</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable">U</a></span> : <span class="id">measurable</span> <span class="id">U</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#kadd">X</a></span>] (<span class="id">kadd</span> ^~ <span class="id">U</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
<span class="id">move</span>=&gt; <span class="id">mU</span>; <span class="id">rewrite</span> /<span class="id">kadd</span>.<br/>
<span class="id">rewrite</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">_</span>) = (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">k1</span> <span class="id">x</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kadd.k2">U</a></span> + <span class="id">k2</span> <span class="id">x</span> <span class="id">U</span>)); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">x</span>; <span class="id">rewrite</span> -<span class="id">measure_addE</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">emeasurable_funD</span>; <span class="id">exact</span>/<span class="id">measurable_kernel</span>.<br/>
Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="kwd">Definition</span> <span class="id">_</span> :=<br/>
&nbsp;&nbsp;@<span class="id">isKernel.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kadd">_</a></span> <span class="id">_</span> <span class="id">kadd</span> <span class="id">measurable_fun_kadd</span>.<br/>
<span class="kwd">End</span> <span class="id">kadd</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">sfkadd</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">X</a></span> : <span class="id">measurableType</span> <span class="id">d</span>) (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Y</a></span> : <span class="id">measurableType</span> <span class="id">d</span>') (<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">R</a></span> : <span class="id">realType</span>).<br/>
<span class="kwd">Variables</span> <span class="id">k1</span> <span class="id">k2</span> : <span class="id">R</span>.-<span class="id">sfker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">sfinite_kadd</span> : <span class="kwd">exists2</span> <span class="id">k_</span> : (<span class="id">R</span>.-<span class="id">ker</span> <span class="id">_</span> ~&gt; <span class="id">_</span>)^<span class="id">nat</span>,<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id">measure_fam_uub</span> (<span class="id">k_</span> <span class="id">n</span>) &amp;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">U</span>, <span class="id">measurable</span> <span class="id">U</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">kadd</span> <span class="id">k1</span> <span class="id">k2</span> <span class="id">x</span> <span class="id"><a href="mathcomp.analysis.measure.html#mseries">U</a></span> = <span class="id">mseries</span> (<span class="id">k_</span> ^~ <span class="id">x</span>) 0 <span class="id">U</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
<span class="id">have</span> [<span class="id">f1</span> <span class="id">hk1</span>] := <span class="id">sfinite_kernel</span> <span class="id">k1</span>; <span class="id">have</span> [<span class="id">f2</span> <span class="id">hk2</span>] := <span class="id">sfinite_kernel</span> <span class="id">k2</span>.<br/>
<span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; [<span class="id">the</span> <span class="id">_</span>.-<span class="id">ker</span> <span class="id">_</span> ~&gt; <span class="id">_</span> <span class="id">of</span> <span class="id">kadd</span> (<span class="id">f1</span> <span class="id">n</span>) (<span class="id">f2</span> <span class="id">n</span>)]).<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> [<span class="id">r1</span> <span class="id">f1r1</span>] := <span class="id">measure_uub</span> (<span class="id">f1</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span> [<span class="id">r2</span> <span class="id">f2r2</span>] := <span class="id">measure_uub</span> (<span class="id">f2</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">r1</span> + <span class="id">r2</span>)%<span class="id">R</span> =&gt; <span class="id">x</span>/=.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">msum</span> !<span class="id">big_ord_recr</span>/= <span class="id">big_ord0</span> <span class="id">add0e</span> <span class="id">EFinD</span> <span class="id">lte_add</span>.<br/>
<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">U</span> <span class="id">mU</span>.<br/>
<span class="id">rewrite</span> /<span class="id">kadd</span>/= -/(<span class="id">measure_add</span> (<span class="id">k1</span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfkadd.k2">x</a></span>) (<span class="id">k2</span> <span class="id"><a href="mathcomp.analysis.measure.html#measure_addE">x</a></span>)) <span class="id">measure_addE</span> <span class="id">hk1</span>//= <span class="id">hk2</span>//=.<br/>
<span class="id">rewrite</span> /<span class="id">mseries</span> -<span class="id">nneseriesD</span>//; <span class="id">apply</span>: <span class="id">eq_eseriesr</span> =&gt; <span class="id">n</span> <span class="id">_</span> /=.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -/(<span class="id">measure_add</span> (<span class="id">f1</span> <span class="id">n</span> <span class="id">x</span>) (<span class="id">f2</span> <span class="id">n</span> <span class="id"><a href="mathcomp.analysis.measure.html#measure_addE">x</a></span>)) <span class="id">measure_addE</span>.<br/>
Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="kwd">Definition</span> <span class="id">_</span> <span class="id">t</span> :=<br/>
&nbsp;&nbsp;<span class="id">Kernel_isSFinite_subdef.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfkadd.R">_</a></span> <span class="id">_</span> <span class="id">R</span> (<span class="id">kadd</span> <span class="id">k1</span> <span class="id"><a href="mathcomp.analysis.kernel.html#sfkadd.sfinite_kadd">k2</a></span>) <span class="id">sfinite_kadd</span>.<br/>
<span class="kwd">End</span> <span class="id">sfkadd</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">fkadd</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">X</a></span> : <span class="id">measurableType</span> <span class="id">d</span>) (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Y</a></span> : <span class="id">measurableType</span> <span class="id">d</span>') (<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">R</a></span> : <span class="id">realType</span>).<br/>
<span class="kwd">Variables</span> <span class="id">k1</span> <span class="id">k2</span> : <span class="id">R</span>.-<span class="id">fker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">kadd_finite_uub</span> : <span class="id">measure_fam_uub</span> (<span class="id">kadd</span> <span class="id">k1</span> <span class="id">k2</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
<span class="id">have</span> [<span class="id">f1</span> <span class="id">hk1</span>] := <span class="id">measure_uub</span> <span class="id">k1</span>; <span class="id">have</span> [<span class="id">f2</span> <span class="id">hk2</span>] := <span class="id">measure_uub</span> <span class="id">k2</span>.<br/>
<span class="kwd">exists</span> (<span class="id">f1</span> + <span class="id">f2</span>)%<span class="id">R</span> =&gt; <span class="id">x</span>; <span class="id">rewrite</span> /<span class="id">kadd</span> /=.<br/>
<span class="id">rewrite</span> -/(<span class="id">measure_add</span> (<span class="id">k1</span> <span class="id"><a href="mathcomp.analysis.kernel.html#fkadd.k2">x</a></span>) (<span class="id">k2</span> <span class="id">x</span>)).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">measure_addE</span> <span class="id">EFinD</span>; <span class="id">exact</span>: <span class="id">lte_add</span>.<br/>
Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="kwd">Definition</span> <span class="id">_</span> <span class="id">t</span> :=<br/>
&nbsp;&nbsp;<span class="id">Kernel_isFinite.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.kernel.html#fkadd.R">_</a></span> <span class="id">_</span> <span class="id">R</span> (<span class="id">kadd</span> <span class="id">k1</span> <span class="id"><a href="mathcomp.analysis.kernel.html#fkadd.kadd_finite_uub">k2</a></span>) <span class="id">kadd_finite_uub</span>.<br/>
<span class="kwd">End</span> <span class="id">fkadd</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">measurable_fun_mnormalize</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">X</a></span> : <span class="id">measurableType</span> <span class="id">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Y</a></span> : <span class="id">measurableType</span> <span class="id">d</span>') (<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">R</a></span> : <span class="id">realType</span>) (<span class="id">k</span> : <span class="id">R</span>.-<span class="id">ker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>) :<br/>
&nbsp;&nbsp;<span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id">X</span>] (<span class="kwd">fun</span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">the</a></span> <span class="id">probability</span> <span class="id">_</span> <span class="id">_</span> <span class="id">of</span> <span class="id">mnormalize</span> (<span class="id">k</span> <span class="id">x</span>) <span class="id">point</span>] : <span class="id">pprobability</span> <span class="id">Y</span> <span class="id">R</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
<span class="id">apply</span>: (@<span class="id">measurability</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span><br/>
&nbsp;&nbsp;(@<span class="id">pset</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set">_</a></span> : <span class="id">set</span> (<span class="id">set</span> (<span class="id">pprobability</span> <span class="id">Y</span> <span class="id">R</span>)))) =&gt; //.<br/>
<span class="id">move</span>=&gt; <span class="id">_</span> -[<span class="id">_</span> [<span class="id">r</span> <span class="id">r01</span>] [<span class="id">Ys</span> <span class="id">mYs</span> &lt;-]] &lt;-.<br/>
<span class="id">rewrite</span> /<span class="id">mnormalize</span> /<span class="id">mset</span> /<span class="id">preimage</span>/=.<br/>
<span class="id">apply</span>: <span class="id">emeasurable_fun_infty_o</span> =&gt; //.<br/>
<span class="id">rewrite</span> /<span class="id">mnormalize</span>/=.<br/>
<span class="id">rewrite</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">_</span>) = (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="kwd">if</span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#setT">k</a></span> <span class="id">x</span> <span class="id">setT</span> == 0) || (<span class="id"><a href="mathcomp.classical.classical_sets.html#setT">k</a></span> <span class="id">x</span> <span class="id">setT</span> == +<span class="id">oo</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> \<span class="id">d_point</span> <span class="id">Ys</span> <span class="kwd">else</span> <span class="id">k</span> <span class="id">x</span> <span class="id">Ys</span> * ((<span class="id">fine</span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#setT">k</a></span> <span class="id">x</span> <span class="id">setT</span>))^-1)%:<span class="id">E</span>)); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">x</span>/=; <span class="id">case</span>: <span class="id">ifPn</span>.<br/>
<span class="id">apply</span>: <span class="id">measurable_fun_if</span> =&gt; //.<br/>
- <span class="id">apply</span>: (<span class="id">measurable_fun_bool</span> <span class="id">true</span>) =&gt; //.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">_</span> : <span class="id">_</span> @^-1` <span class="id">_</span> = [<span class="id">set</span> <span class="id">t</span> | <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">k</a></span> <span class="id">t</span> <span class="id">setT</span> == 0] `|`<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">set</span> <span class="id">t</span> | <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">k</a></span> <span class="id">t</span> <span class="id">setT</span> == +<span class="id">oo</span>]); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">seteqP</span>; <span class="id">split</span>=&gt; <span class="id">x</span> /= /<span class="id">orP</span>//.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">measurableU</span>; <span class="id">exact</span>: <span class="id">kernel_measurable_eq_cst</span>.<br/>
- <span class="id">apply</span>/<span class="id">emeasurable_funM</span>; <span class="id">first</span> <span class="id">exact</span>/<span class="id">measurable_funTS</span>/<span class="id">measurable_kernel</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">EFin_measurable_fun</span>; <span class="id">rewrite</span> <span class="id">setTI</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>: (@<span class="id">measurable_comp</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> [<span class="id">set</span> <span class="id">r</span> : <span class="id">R</span> | <span class="id">r</span> != 0%<span class="id">R</span>]).<br/>
&nbsp;&nbsp;+ <span class="id">exact</span>: <span class="id">open_measurable</span>.<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">move</span>=&gt; /= <span class="id">_</span> [<span class="id">x</span> /<span class="id">norP</span>[<span class="id">s0</span> <span class="id">soo</span>]] &lt;-; <span class="id">rewrite</span> -<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineK">eqe</a></span> <span class="id">fineK</span> ?<span class="id">ge0_fin_numE</span> ?<span class="id">ltey</span>.<br/>
&nbsp;&nbsp;+ <span class="id">apply</span>: <span class="id">open_continuous_measurable_fun</span> =&gt; //; <span class="id">apply</span>/<span class="id">in_setP</span> =&gt; <span class="id">x</span> /= <span class="id">x0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">inv_continuous</span>.<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">measurableT_comp</span> =&gt; //; <span class="id">exact</span>/<span class="id">measurable_funS</span>/<span class="id">measurable_kernel</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id">knormalize</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">X</a></span> : <span class="id">measurableType</span> <span class="id">d</span>) (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Y</a></span> : <span class="id">measurableType</span> <span class="id">d</span>') (<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">R</a></span> : <span class="id">realType</span>).<br/>
<span class="kwd">Variable</span> <span class="id"><a href="mathcomp.analysis.kernel.html#knormalize.R">f</a></span> : <span class="id">R</span>.-<span class="id"><a href="mathcomp.analysis.kernel.html#knormalize.X">ker</a></span> <span class="id">X</span> ~&gt; <span class="id">Y</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">knormalize</span> (<span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">P</a></span> : <span class="id">probability</span> <span class="id">Y</span> <span class="id">R</span>) : <span class="id">X</span> -&gt; {<span class="id">measure</span> <span class="id"><a href="mathcomp.analysis.kernel.html#knormalize.Y">set</a></span> <span class="id">Y</span> -&gt; \<span class="id"><a href="mathcomp.analysis.kernel.html#knormalize.R">bar</a></span> <span class="id">R</span>} :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">x</span> =&gt; [<span class="id"><a href="mathcomp.analysis.measure.html#Measure.Exports.measure">the</a></span> <span class="id">measure</span> <span class="id">_</span> <span class="id">_</span> <span class="id">of</span> <span class="id">mnormalize</span> (<span class="id">f</span> <span class="id">x</span>) <span class="id">P</span>].<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">P</a></span> : <span class="id">probability</span> <span class="id">Y</span> <span class="id">R</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">measurable_fun_knormalize</span> <span class="id">U</span> :<br/>
&nbsp;&nbsp;<span class="id">measurable</span> <span class="id">U</span> -&gt; <span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#knormalize">X</a></span>] (<span class="id">knormalize</span> <span class="id">P</span> ^~ <span class="id">U</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
<span class="id">move</span>=&gt; <span class="id">mU</span>; <span class="id">rewrite</span> /<span class="id">knormalize</span>/= /<span class="id">mnormalize</span> /=.<br/>
<span class="id">rewrite</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">_</span>) = (<span class="kwd">fun</span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">f</a></span> <span class="id">x</span> <span class="id">setT</span> == 0 <span class="kwd">then</span> <span class="id">P</span> <span class="id">U</span> <span class="kwd">else</span> <span class="kwd">if</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">f</a></span> <span class="id">x</span> <span class="id">setT</span> == +<span class="id">oo</span> <span class="kwd">then</span> <span class="id">P</span> <span class="id">U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id">f</span> <span class="id">x</span> <span class="id">U</span> * (<span class="id">fine</span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#setT">f</a></span> <span class="id">x</span> <span class="id">setT</span>))^-1%:<span class="id">E</span>)); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">x</span>; <span class="id">case</span>: <span class="id">ifPn</span> =&gt; [/<span class="id">orP</span>[-&gt;//|-&gt;]|]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">case</span>: <span class="id">ifPn</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">negb_or</span>=&gt; /<span class="id">andP</span>[/<span class="id">negbTE</span> -&gt; /<span class="id">negbTE</span> -&gt;].<br/>
<span class="id">apply</span>: <span class="id">measurable_fun_if</span> =&gt; //; [<span class="id">exact</span>: <span class="id">kernel_measurable_fun_eq_cst</span>|].<br/>
<span class="id">apply</span>: <span class="id">measurable_fun_if</span> =&gt; //.<br/>
- <span class="id">rewrite</span> <span class="id">setTI</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">measurable</span> <span class="id">X</span>](<span class="id">_</span> : <span class="id">_</span> = [<span class="id">set</span> <span class="id"><a href="mathcomp.analysis.kernel.html#knormalize.f">t</a></span> | <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">f</a></span> <span class="id">t</span> <span class="id">setT</span> != 0]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">kernel_measurable_neq_cst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">seteqP</span>; <span class="id">split</span> =&gt; [<span class="id">x</span> /<span class="id">negbT</span>//|<span class="id">x</span> /<span class="id">negbTE</span>].<br/>
- <span class="id">apply</span>: (@<span class="id">measurable_funS</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">_</a></span> <span class="id">_</span> <span class="id">setT</span>) =&gt; //.<br/>
&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">kernel_measurable_fun_eq_cst</span>.<br/>
- <span class="id">apply</span>: <span class="id">emeasurable_funM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">have</span> := <span class="id">measurable_kernel</span> <span class="id">f</span> <span class="id">U</span> <span class="id">mU</span>; <span class="id">exact</span>: <span class="id">measurable_funS</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">EFin_measurable_fun</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>: (@<span class="id">measurable_comp</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> [<span class="id">set</span> <span class="id"><a href="mathcomp.analysis.kernel.html#knormalize.R">r</a></span> : <span class="id">R</span> | <span class="id">r</span> != 0%<span class="id">R</span>]) =&gt; //.<br/>
&nbsp;&nbsp;+ <span class="id">exact</span>: <span class="id">open_measurable</span>.<br/>
&nbsp;&nbsp;+ <span class="id">move</span>=&gt; /= <span class="id">r</span> [<span class="id">t</span>] [] [<span class="id">_</span> <span class="id">ft0</span>] <span class="id">ftoo</span> <span class="id">ftr</span>; <span class="id">apply</span>/<span class="id">eqP</span> =&gt; <span class="id">r0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move</span>: (<span class="id">ftr</span>); <span class="id">rewrite</span> <span class="id">r0</span> =&gt; /<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">fine_eq0</span> ?<span class="id">ft0</span>//.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ge0_fin_numE</span>// <span class="id">lt_neqAle</span> <span class="id">leey</span> <span class="id">ftoo</span>.<br/>
&nbsp;&nbsp;+ <span class="id">apply</span>: <span class="id">open_continuous_measurable_fun</span> =&gt; //; <span class="id">apply</span>/<span class="id">in_setP</span> =&gt; <span class="id">x</span> /= <span class="id">x0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">inv_continuous</span>.<br/>
&nbsp;&nbsp;+ <span class="id">apply</span>: <span class="id">measurableT_comp</span> =&gt; //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">have</span> := <span class="id">measurable_kernel</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT">f</a></span> <span class="id">_</span> <span class="id">measurableT</span>; <span class="id">exact</span>: <span class="id">measurable_funS</span>.<br/>
Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="kwd">Definition</span> <span class="id">_</span> := <span class="id">isKernel.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.kernel.html#knormalize.R">_</a></span> <span class="id">_</span> <span class="id">R</span> (<span class="id">knormalize</span> <span class="id">P</span>)<br/>
&nbsp;&nbsp;<span class="id">measurable_fun_knormalize</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">knormalize1</span> <span class="id"><a href="mathcomp.analysis.kernel.html#knormalize">x</a></span> : <span class="id">knormalize</span> <span class="id">P</span> <span class="id">x</span> [<span class="id">set</span>: <span class="id">Y</span>] = 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">knormalize</span>/= <span class="id">probability_setT</span>. Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="kwd">Definition</span> <span class="id">_</span> :=<br/>
&nbsp;&nbsp;@<span class="id">Kernel_isProbability.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">knormalize</span> <span class="id">P</span>) <span class="id">knormalize1</span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id">knormalize</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">kcomp_def</span>.<br/>
<span class="kwd">Context</span> <span class="id">d1</span> <span class="id">d2</span> <span class="id">d3</span> (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">X</a></span> : <span class="id">measurableType</span> <span class="id">d1</span>) (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Y</a></span> : <span class="id">measurableType</span> <span class="id">d2</span>)<br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Z</a></span> : <span class="id">measurableType</span> <span class="id">d3</span>) (<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">R</a></span> : <span class="id">realType</span>).<br/>
<span class="kwd">Variable</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_def.X">l</a></span> : <span class="id">X</span> -&gt; {<span class="id">measure</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_def.Y">set</a></span> <span class="id">Y</span> -&gt; \<span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_def.R">bar</a></span> <span class="id">R</span>}.<br/>
<span class="kwd">Variable</span> <span class="id">k</span> : (<span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_def.Y">X</a></span> * <span class="id">Y</span>)%<span class="id">type</span> -&gt; {<span class="id">measure</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_def.Z">set</a></span> <span class="id">Z</span> -&gt; \<span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_def.R">bar</a></span> <span class="id">R</span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">kcomp</span> <span class="id">x</span> <span class="id">U</span> := \<span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_def.l">int</a></span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">_y</span> <span class="id">k</span> (<span class="id">x</span>, <span class="id">y</span>) <span class="id">U</span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id">kcomp_def</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">kcomp_is_measure</span>.<br/>
<span class="kwd">Context</span> <span class="id">d1</span> <span class="id">d2</span> <span class="id">d3</span> (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">X</a></span> : <span class="id">measurableType</span> <span class="id">d1</span>) (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Y</a></span> : <span class="id">measurableType</span> <span class="id">d2</span>)<br/>
&nbsp;(<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Z</a></span> : <span class="id">measurableType</span> <span class="id">d3</span>) (<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">R</a></span> : <span class="id">realType</span>).<br/>
<span class="kwd">Variable</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_is_measure.R">l</a></span> : <span class="id">R</span>.-<span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_is_measure.X">ker</a></span> <span class="id">X</span> ~&gt; <span class="id">Y</span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_is_measure.R">k</a></span> : <span class="id">R</span>.-<span class="id">ker</span> [<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">the</a></span> <span class="id">measurableType</span> <span class="id">_</span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_is_measure.Y">X</a></span> * <span class="id">Y</span>] ~&gt; <span class="id">Z</span>.<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> "<span class="id">l</span> \; <span class="id">k</span>" := (<span class="id">kcomp</span> <span class="id">l</span> <span class="id">k</span>).<br/>
<br/>
<span class="kwd">Let</span> <span class="id">kcomp0</span> <span class="id">x</span> : (<span class="id">l</span> \; <span class="id">k</span>) <span class="id">x</span> <span class="id">set0</span> = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">kcomp</span> (<span class="id">eq_integral</span> (<span class="id">cst</span> 0)) ?<span class="id">integral0</span>// =&gt; <span class="id">y</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">measure0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">kcomp_ge0</span> <span class="id">x</span> <span class="id">U</span> : 0 &lt;= (<span class="id">l</span> \; <span class="id">k</span>) <span class="id">x</span> <span class="id">U</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
 <span class="id">exact</span>: <span class="id">integral_ge0</span>. Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">kcomp_sigma_additive</span> <span class="id"><a href="mathcomp.analysis.measure.html#semi_sigma_additive">x</a></span> : <span class="id">semi_sigma_additive</span> ((<span class="id">l</span> \; <span class="id">k</span>) <span class="id">x</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
<span class="id">move</span>=&gt; <span class="id">U</span> <span class="id">mU</span> <span class="id">tU</span> <span class="id">mUU</span>; <span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> --&gt; <span class="id">X</span>](<span class="id">_</span> : <span class="id">_</span> =<br/>
&nbsp;&nbsp;\<span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_is_measure.l">int</a></span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">_y</span> (\<span class="id">sum_</span>(<span class="id">n</span> &lt;<span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_is_measure.k">oo</a></span>) <span class="id">k</span> (<span class="id">x</span>, <span class="id">y</span>) (<span class="id">U</span> <span class="id">n</span>))); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">eq_integral</span> =&gt; <span class="id">V</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">esym</span>/<span class="id">cvg_lim</span> =&gt; //; <span class="id">exact</span>/<span class="id">measure_semi_sigma_additive</span>.<br/>
<span class="id">apply</span>/<span class="id">cvg_closeP</span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">is_cvg_nneseries</span> =&gt; <span class="id">n</span> <span class="id">_</span>; <span class="id">exact</span>: <span class="id">integral_ge0</span>.<br/>
<span class="id">rewrite</span> <span class="id">closeE</span>// <span class="id">integral_nneseries</span>// =&gt; <span class="id">n</span>.<br/>
<span class="id">exact</span>: <span class="id">measurableT_comp</span> (<span class="id">measurable_kernel</span> <span class="id">k</span> <span class="id">_</span> (<span class="id">mU</span> <span class="id">n</span>)) <span class="id">_</span>.<br/>
Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="kwd">Definition</span> <span class="id">_</span> <span class="id">x</span> := <span class="id">isMeasure.Build</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_is_measure.R">_</a></span> <span class="id">_</span> <span class="id">R</span><br/>
&nbsp;&nbsp;((<span class="id">l</span> \; <span class="id">k</span>) <span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_is_measure.kcomp0">x</a></span>) (<span class="id">kcomp0</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_is_measure.kcomp_ge0">x</a></span>) (<span class="id">kcomp_ge0</span> <span class="id">x</span>) (@<span class="id">kcomp_sigma_additive</span> <span class="id">x</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">mkcomp</span> : <span class="id">X</span> -&gt; {<span class="id">measure</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_is_measure.Z">set</a></span> <span class="id">Z</span> -&gt; \<span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_is_measure.R">bar</a></span> <span class="id">R</span>} := <span class="kwd">fun</span> <span class="id">x</span> =&gt;<br/>
&nbsp;&nbsp;[<span class="id"><a href="mathcomp.analysis.measure.html#Measure.Exports.measure">the</a></span> <span class="id">measure</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_is_measure.l">of</a></span> (<span class="id">l</span> \; <span class="id">k</span>) <span class="id">x</span>].<br/>
<br/>
<span class="kwd">End</span> <span class="id">kcomp_is_measure</span>.<br/>
<br/>
<span class="kwd">Notation</span> "<span class="id">l</span> \; <span class="id">k</span>" := (<span class="id">mkcomp</span> <span class="id">l</span> <span class="id">k</span>) : <span class="id">ereal_scope</span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id">KCOMP_FINITE_KERNEL</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">kcomp_finite_kernel_kernel</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' <span class="id">d3</span> (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">X</a></span> : <span class="id">measurableType</span> <span class="id">d</span>) (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Y</a></span> : <span class="id">measurableType</span> <span class="id">d</span>')<br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Z</a></span> : <span class="id">measurableType</span> <span class="id">d3</span>) (<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">R</a></span> : <span class="id">realType</span>) (<span class="id">l</span> : <span class="id">R</span>.-<span class="id">fker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>)<br/>
&nbsp;&nbsp;(<span class="id">k</span> : <span class="id">R</span>.-<span class="id">ker</span> [<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">the</a></span> <span class="id">measurableType</span> <span class="id">_</span> <span class="id">of</span> <span class="id">X</span> * <span class="id">Y</span>] ~&gt; <span class="id">Z</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">measurable_fun_kcomp_finite</span> <span class="id">U</span> :<br/>
&nbsp;&nbsp;<span class="id">measurable</span> <span class="id">U</span> -&gt; <span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id">X</span>] ((<span class="id">l</span> \; <span class="id">k</span>) ^~ <span class="id">U</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
<span class="id">move</span>=&gt; <span class="id">mU</span>; <span class="id">apply</span>: (<span class="id">measurable_fun_integral_finite_kernel</span> (<span class="id">k</span> ^~ <span class="id">U</span>)) =&gt; //=.<br/>
<span class="id">exact</span>/<span class="id">measurable_kernel</span>.<br/>
Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="kwd">Definition</span> <span class="id">_</span> :=<br/>
&nbsp;&nbsp;<span class="id">isKernel.Build</span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_FINITE_KERNEL.kcomp_finite_kernel_kernel.X">_</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_FINITE_KERNEL.kcomp_finite_kernel_kernel.Z">_</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_FINITE_KERNEL.kcomp_finite_kernel_kernel.R">X</a></span> <span class="id">Z</span> <span class="id">R</span> (<span class="id">l</span> \; <span class="id">k</span>) <span class="id">measurable_fun_kcomp_finite</span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id">kcomp_finite_kernel_kernel</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">kcomp_finite_kernel_finite</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' <span class="id">d3</span> (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">X</a></span> : <span class="id">measurableType</span> <span class="id">d</span>) (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Y</a></span> : <span class="id">measurableType</span> <span class="id">d</span>')<br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Z</a></span> : <span class="id">measurableType</span> <span class="id">d3</span>) (<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">R</a></span> : <span class="id">realType</span>).<br/>
<span class="kwd">Variable</span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_FINITE_KERNEL.kcomp_finite_kernel_finite.R">l</a></span> : <span class="id">R</span>.-<span class="id">fker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_FINITE_KERNEL.kcomp_finite_kernel_finite.R">k</a></span> : <span class="id">R</span>.-<span class="id">fker</span> [<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">the</a></span> <span class="id">measurableType</span> <span class="id">_</span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_FINITE_KERNEL.kcomp_finite_kernel_finite.Y">X</a></span> * <span class="id">Y</span>] ~&gt; <span class="id">Z</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">mkcomp_finite</span> : <span class="id">measure_fam_uub</span> (<span class="id">l</span> \; <span class="id">k</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
<span class="id">have</span> /<span class="id">measure_fam_uubP</span>[<span class="id">r</span> <span class="id">hr</span>] := <span class="id">measure_uub</span> <span class="id">k</span>.<br/>
<span class="id">have</span> /<span class="id">measure_fam_uubP</span>[<span class="id">s</span> <span class="id">hs</span>] := <span class="id">measure_uub</span> <span class="id">l</span>.<br/>
<span class="id">apply</span>/<span class="id">measure_fam_uubP</span>; <span class="kwd">exists</span> (<span class="id">PosNum</span> [<span class="id">gt0</span> <span class="id">of</span> (<span class="id">r</span>%:<span class="id">num</span> * <span class="id">s</span>%:<span class="id">num</span>)%<span class="id">R</span>]) =&gt; <span class="id">x</span> /=.<br/>
<span class="id">apply</span>: (@<span class="id">le_lt_trans</span> <span class="id">_</span> <span class="id">_</span> (\<span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_FINITE_KERNEL.kcomp_finite_kernel_finite.l">int</a></span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">__</span> <span class="id">r</span>%:<span class="id">num</span>%:<span class="id">E</span>)).<br/>
&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">ge0_le_integral</span> =&gt; //.<br/>
&nbsp;&nbsp;- <span class="id">exact</span>: <span class="id">measurableT_comp</span> (<span class="id">measurable_kernel</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT">k</a></span> <span class="id">_</span> <span class="id">measurableT</span>) <span class="id">_</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">y</span> <span class="id">_</span>; <span class="id">exact</span>/<span class="id">ltW</span>/<span class="id">hr</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">integral_cst</span>//= <span class="id">EFinM</span> <span class="id">lte_pmul2l</span>.<br/>
Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="kwd">Definition</span> <span class="id">_</span> :=<br/>
&nbsp;&nbsp;<span class="id">Kernel_isFinite.Build</span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_FINITE_KERNEL.kcomp_finite_kernel_finite.X">_</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_FINITE_KERNEL.kcomp_finite_kernel_finite.Z">_</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_FINITE_KERNEL.kcomp_finite_kernel_finite.R">X</a></span> <span class="id">Z</span> <span class="id">R</span> (<span class="id">l</span> \; <span class="id">k</span>) <span class="id">mkcomp_finite</span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id">kcomp_finite_kernel_finite</span>.<br/>
<span class="kwd">End</span> <span class="id">KCOMP_FINITE_KERNEL</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">kcomp_sfinite_kernel</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' <span class="id">d3</span> (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">X</a></span> : <span class="id">measurableType</span> <span class="id">d</span>) (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Y</a></span> : <span class="id">measurableType</span> <span class="id">d</span>')<br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Z</a></span> : <span class="id">measurableType</span> <span class="id">d3</span>) (<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">R</a></span> : <span class="id">realType</span>).<br/>
<span class="kwd">Variable</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_sfinite_kernel.R">l</a></span> : <span class="id">R</span>.-<span class="id">sfker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_sfinite_kernel.R">k</a></span> : <span class="id">R</span>.-<span class="id">sfker</span> [<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">the</a></span> <span class="id">measurableType</span> <span class="id">_</span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kcomp_sfinite_kernel.Y">X</a></span> * <span class="id">Y</span>] ~&gt; <span class="id">Z</span>.<br/>
<br/>
<span class="kwd">Import</span> <span class="id">KCOMP_FINITE_KERNEL</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">mkcomp_sfinite</span> : <span class="kwd">exists</span> <span class="id">k_</span> : (<span class="id">R</span>.-<span class="id">fker</span> <span class="id">X</span> ~&gt; <span class="id">Z</span>)^<span class="id">nat</span>,<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">U</span>, <span class="id">measurable</span> <span class="id">U</span> -&gt; (<span class="id">l</span> \; <span class="id">k</span>) <span class="id">x</span> <span class="id"><a href="mathcomp.analysis.kernel.html#kseries">U</a></span> = <span class="id">kseries</span> <span class="id">k_</span> <span class="id">x</span> <span class="id">U</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
<span class="id">have</span> [<span class="id">k_</span> <span class="id">hk_</span>] := <span class="id">sfinite_kernel</span> <span class="id">k</span>; <span class="id">have</span> [<span class="id">l_</span> <span class="id">hl_</span>] := <span class="id">sfinite_kernel</span> <span class="id">l</span>.<br/>
<span class="id">have</span> [<span class="id">kl</span> <span class="id">hkl</span>] : <span class="kwd">exists</span> <span class="id">kl</span> : (<span class="id">R</span>.-<span class="id">fker</span> <span class="id">X</span> ~&gt; <span class="id">Z</span>) ^<span class="id">nat</span>, <span class="kwd">forall</span> <span class="id">x</span> <span class="id">U</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;\<span class="id">esum_</span>(<span class="id">i</span> <span class="kwd">in</span> <span class="id">setT</span>) (<span class="id">l_</span> <span class="id">i</span>.2 \; <span class="id">k_</span> <span class="id">i</span>.1) <span class="id">x</span> <span class="id">U</span> = \<span class="id">sum_</span>(<span class="id">i</span> &lt;<span class="id">oo</span>) <span class="id">kl</span> <span class="id">i</span> <span class="id">x</span> <span class="id">U</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> /<span class="id">ppcard_eqP</span>[<span class="id">f</span>] : ([<span class="id">set</span>: <span class="id">nat</span>] #= [<span class="id">set</span>: <span class="id">nat</span> * <span class="id">nat</span>])%<span class="id">card</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">card_eq_sym</span>; <span class="id">exact</span>: <span class="id">card_nat2</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; [<span class="id">the</span> <span class="id">_</span>.-<span class="id">fker</span> <span class="id">_</span> ~&gt; <span class="id">_</span> <span class="id">of</span> <span class="id">l_</span> (<span class="id">f</span> <span class="id">i</span>).2 \; <span class="id">k_</span> (<span class="id">f</span> <span class="id">i</span>).1]) =&gt; <span class="id">x</span> <span class="id">U</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">reindex_esum</span> [<span class="id">set</span>: <span class="id">nat</span>] <span class="id">_</span> <span class="id">f</span>)// <span class="id">nneseries_esum</span>// <span class="id">fun_true</span>.<br/>
<span class="kwd">exists</span> <span class="id">kl</span> =&gt; <span class="id">x</span> <span class="id">U</span> <span class="id">mU</span>.<br/>
<span class="id">transitivity</span> (([<span class="id">the</span> <span class="id">_</span>.-<span class="id">ker</span> <span class="id">_</span> ~&gt; <span class="id">_</span> <span class="id">of</span> <span class="id">kseries</span> <span class="id">l_</span>] \;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">the</span> <span class="id">_</span>.-<span class="id">ker</span> <span class="id">_</span> ~&gt; <span class="id">_</span> <span class="id">of</span> <span class="id">kseries</span> <span class="id">k_</span>]) <span class="id">x</span> <span class="id">U</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> /= /<span class="id">kcomp</span> [<span class="kwd">in</span> <span class="id">RHS</span>](<span class="id">eq_measure_integral</span> (<span class="id">l</span> <span class="id">x</span>)); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; *; <span class="id">rewrite</span> <span class="id">hl_</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">eq_integral</span> =&gt; <span class="id">y</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">hk_</span>.<br/>
<span class="id">rewrite</span> /= /<span class="id">kcomp</span>/= <span class="id">integral_nneseries</span>//=; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">n</span>; <span class="id">exact</span>: <span class="id">measurableT_comp</span> (<span class="id">measurable_kernel</span> (<span class="id">k_</span> <span class="id">n</span>) <span class="id">_</span> <span class="id">mU</span>) <span class="id">_</span>.<br/>
<span class="id">transitivity</span> (\<span class="id">sum_</span>(<span class="id">i</span> &lt;<span class="id">oo</span>) \<span class="id">sum_</span>(<span class="id">j</span> &lt;<span class="id">oo</span>) (<span class="id">l_</span> <span class="id">j</span> \; <span class="id">k_</span> <span class="id">i</span>) <span class="id">x</span> <span class="id">U</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">eq_eseriesr</span> =&gt; <span class="id">i</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">integral_kseries</span>//.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">exact</span>: <span class="id">measurableT_comp</span> (<span class="id">measurable_kernel</span> (<span class="id">k_</span> <span class="id">i</span>) <span class="id">_</span> <span class="id">mU</span>) <span class="id">_</span>.<br/>
<span class="id">rewrite</span> /<span class="id">mseries</span> -<span class="id">hkl</span>/=.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#setT">_</a></span> : <span class="id">setT</span> = <span class="id">setT</span> `*`` (<span class="kwd">fun</span>=&gt; <span class="id">setT</span>)); <span class="id">last</span> <span class="kwd">by</span> <span class="id">apply</span>/<span class="id">seteqP</span>; <span class="id">split</span>.<br/>
<span class="id">rewrite</span> -(@<span class="id">esum_esum</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">i</span> <span class="id">j</span> =&gt; (<span class="id">l_</span> <span class="id">j</span> \; <span class="id">k_</span> <span class="id">i</span>) <span class="id">x</span> <span class="id">U</span>))//.<br/>
<span class="id">rewrite</span> <span class="id">nneseries_esum</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">n</span> <span class="id">_</span>; <span class="id">exact</span>: <span class="id">nneseries_ge0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">fun_true</span>; <span class="id">apply</span>: <span class="id">eq_esum</span> =&gt; /= <span class="id">i</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">nneseries_esum</span>// <span class="id">fun_true</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">measurable_fun_mkcomp_sfinite</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable">U</a></span> : <span class="id">measurable</span> <span class="id">U</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id">X</span>] ((<span class="id">l</span> \; <span class="id">k</span>) ^~ <span class="id">U</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
<span class="id">move</span>=&gt; <span class="id">mU</span>; <span class="id">apply</span>: (<span class="id">measurable_fun_integral_sfinite_kernel</span> (<span class="id">k</span> ^~ <span class="id">U</span>)) =&gt; //.<br/>
<span class="id">exact</span>/<span class="id">measurable_kernel</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">kcomp_sfinite_kernel</span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id">KCOMP_SFINITE_KERNEL</span>.<br/>
<span class="kwd">Section</span> <span class="id">kcomp_sfinite_kernel</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' <span class="id">d3</span> (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">X</a></span> : <span class="id">measurableType</span> <span class="id">d</span>) (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Y</a></span> : <span class="id">measurableType</span> <span class="id">d</span>')<br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Z</a></span> : <span class="id">measurableType</span> <span class="id">d3</span>) (<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">R</a></span> : <span class="id">realType</span>).<br/>
<span class="kwd">Variable</span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_SFINITE_KERNEL.kcomp_sfinite_kernel.R">l</a></span> : <span class="id">R</span>.-<span class="id">sfker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_SFINITE_KERNEL.kcomp_sfinite_kernel.R">k</a></span> : <span class="id">R</span>.-<span class="id">sfker</span> [<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">the</a></span> <span class="id">measurableType</span> <span class="id">_</span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_SFINITE_KERNEL.kcomp_sfinite_kernel.Y">X</a></span> * <span class="id">Y</span>] ~&gt; <span class="id"><a name="KCOMP_SFINITE_KERNEL.HB_unnamed_factory_156">Z</a></span>.<br/>
<br/>
<span class="id">HB.instance</span> <span class="kwd">Definition</span> <span class="id">_</span> :=<br/>
&nbsp;&nbsp;<span class="id">isKernel.Build</span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_SFINITE_KERNEL.kcomp_sfinite_kernel.X">_</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_SFINITE_KERNEL.kcomp_sfinite_kernel.Z">_</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_SFINITE_KERNEL.kcomp_sfinite_kernel.R">X</a></span> <span class="id">Z</span> <span class="id">R</span> (<span class="id">l</span> \; <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_mkcomp_sfinite">k</a></span>) (<span class="id">measurable_fun_mkcomp_sfinite</span> <span class="id">l</span> <span class="id">k</span>).<br/>
<br/>
#[<span class="id">export</span>]<br/>
<span class="id">HB.instance</span> <span class="kwd">Definition</span> <span class="id">_</span> :=<br/>
&nbsp;&nbsp;<span class="id">Kernel_isSFinite.Build</span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_SFINITE_KERNEL.kcomp_sfinite_kernel.X">_</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_SFINITE_KERNEL.kcomp_sfinite_kernel.Z">_</a></span> <span class="id"><a href="mathcomp.analysis.kernel.html#KCOMP_SFINITE_KERNEL.kcomp_sfinite_kernel.R">X</a></span> <span class="id">Z</span> <span class="id">R</span> (<span class="id">l</span> \; <span class="id"><a href="mathcomp.analysis.kernel.html#mkcomp_sfinite">k</a></span>) (<span class="id">mkcomp_sfinite</span> <span class="id">l</span> <span class="id">k</span>).<br/>
<br/>
<span class="kwd">End</span> <span class="id">kcomp_sfinite_kernel</span>.<br/>
<span class="kwd">End</span> <span class="id">KCOMP_SFINITE_KERNEL</span>.<br/>
<span class="id">HB.export</span> <span class="id">KCOMP_SFINITE_KERNEL</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">measurable_fun_preimage_integral</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d</span>' (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">X</a></span> : <span class="id">measurableType</span> <span class="id">d</span>) (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Y</a></span> : <span class="id">measurableType</span> <span class="id">d</span>') (<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">R</a></span> : <span class="id">realType</span>).<br/>
<span class="kwd">Variables</span> (<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_preimage_integral.Y">k</a></span> : <span class="id">Y</span> -&gt; \<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_preimage_integral.R">bar</a></span> <span class="id">R</span>)<br/>
&nbsp;&nbsp;(<span class="id">k_</span> : ({<span class="id">nnsfun</span> <span class="id">Y</span> &gt;-&gt; <span class="id">R</span>}) ^<span class="id">nat</span>)<br/>
&nbsp;&nbsp;(<span class="id">ndk_</span> : <span class="id">nondecreasing_seq</span> (<span class="id">k_</span> : (<span class="id">Y</span> -&gt; <span class="id">R</span>)^<span class="id">nat</span>))<br/>
&nbsp;&nbsp;(<span class="id">k_k</span> : <span class="kwd">forall</span> <span class="id">z</span>, [<span class="id">set</span>: <span class="id">Y</span>] <span class="id">z</span> -&gt; <span class="id">EFin</span> \<span class="id">o</span> (<span class="id">k_</span> ^~ <span class="id">z</span>) --&gt; <span class="id">k</span> <span class="id">z</span>).<br/>
<br/>
<span class="kwd">Let</span> <span class="id">k_2</span> : (<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_preimage_integral.Y">X</a></span> * <span class="id">Y</span> -&gt; <span class="id">R</span>)^<span class="id">nat</span> := <span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">k_</span> <span class="id">n</span> \<span class="id">o</span> <span class="id">snd</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">k_2_ge0</span> <span class="id">n</span> <span class="id">x</span> : (0 &lt;= <span class="id">k_2</span> <span class="id">n</span> <span class="id">x</span>)%<span class="id">R</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
 <span class="kwd">by</span> []. Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="kwd">Definition</span> <span class="id">_</span> <span class="id">n</span> := @<span class="id">isNonNegFun.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">k_2_ge0</span> <span class="id">n</span>).<br/>
<br/>
<span class="kwd">Let</span> <span class="id">mk_2</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">n</a></span> : <span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_preimage_integral.Y">X</a></span> * <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_preimage_integral.k_2">Y</a></span>] (<span class="id">k_2</span> <span class="id">n</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
 <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">measurableT_comp</span> =&gt; //; <span class="id">exact</span>: <span class="id">measurable_snd</span>. Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="kwd">Definition</span> <span class="id">_</span> <span class="id">n</span> := @<span class="id">isMeasurableFun.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">mk_2</span> <span class="id">n</span>).<br/>
<br/>
<span class="kwd">Let</span> <span class="id">fk_2</span> <span class="id"><a href="mathcomp.classical.cardinality.html#finite_set">n</a></span> : <span class="id">finite_set</span> (<span class="id">range</span> (<span class="id">k_2</span> <span class="id">n</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
<span class="id">have</span> := <span class="id">fimfunP</span> (<span class="id">k_</span> <span class="id">n</span>).<br/>
<span class="id">suff</span> : <span class="id">range</span> (<span class="id">k_</span> <span class="id">n</span>) = <span class="id">range</span> (<span class="id">k_2</span> <span class="id">n</span>) <span class="kwd">by</span> <span class="id">move</span>=&gt; &lt;-.<br/>
<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">seteqP</span>; <span class="id">split</span> =&gt; <span class="id">r</span> [<span class="id">y</span> ?] &lt;-; [<span class="kwd">exists</span> (<span class="id">point</span>, <span class="id">y</span>)|<span class="kwd">exists</span> <span class="id">y</span>.2].<br/>
Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="kwd">Definition</span> <span class="id">_</span> <span class="id">n</span> := @<span class="id">FiniteImage.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">fk_2</span> <span class="id">n</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">measurable_fun_preimage_integral</span> (<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_preimage_integral.X">l</a></span> : <span class="id">X</span> -&gt; {<span class="id">measure</span> <span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_preimage_integral.Y">set</a></span> <span class="id">Y</span> -&gt; \<span class="id"><a href="mathcomp.analysis.kernel.html#measurable_fun_preimage_integral.R">bar</a></span> <span class="id">R</span>}) :<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">n</span> <span class="id">r</span>, <span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id">X</span>] (<span class="id">l</span> ^~ (<span class="id">k_</span> <span class="id">n</span> @^-1` [<span class="id">set</span> <span class="id">r</span>]))) -&gt;<br/>
&nbsp;&nbsp;<span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id">X</span>] (<span class="kwd">fun</span> <span class="id">x</span> =&gt; \<span class="id">int</span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">_z</span> <span class="id">k</span> <span class="id">z</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
<span class="id">move</span>=&gt; <span class="id">h</span>; <span class="id">apply</span>: (<span class="id">measurable_fun_xsection_integral</span> (<span class="id">k</span> \<span class="id">o</span> <span class="id">snd</span>) <span class="id">l</span><br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">n</span> =&gt; [<span class="id">the</span> {<span class="id">nnsfun</span> <span class="id">_</span> &gt;-&gt; <span class="id">_</span>} <span class="id">of</span> <span class="id">k_2</span> <span class="id">n</span>])) =&gt; /=.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">k_2</span> =&gt; <span class="id">m</span> <span class="id">n</span> <span class="id">mn</span>; <span class="id">apply</span>/<span class="id">lefP</span> =&gt; -[<span class="id">x</span> <span class="id">y</span>] /=; <span class="id">exact</span>/<span class="id">lefP</span>/<span class="id">ndk_</span>.<br/>
- <span class="kwd">by</span> <span class="id">move</span>=&gt; [<span class="id">x</span> <span class="id">y</span>]; <span class="id">exact</span>: <span class="id">k_k</span>.<br/>
- <span class="id">move</span>=&gt; <span class="id">n</span> <span class="id">r</span> <span class="id">_</span> /= <span class="id">B</span> <span class="id">mB</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> := <span class="id">h</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT">n</a></span> <span class="id">r</span> <span class="id">measurableT</span> <span class="id">B</span> <span class="id">mB</span>; <span class="id">rewrite</span> !<span class="id">setTI</span>.<br/>
&nbsp;&nbsp;<span class="id">suff</span> : (<span class="id">l</span> ^~ (<span class="id">k_</span> <span class="id">n</span> @^-1` [<span class="id">set</span> <span class="id">r</span>])) @^-1` <span class="id">B</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">l</span> <span class="id">x</span> (<span class="id">xsection</span> (<span class="id">k_2</span> <span class="id">n</span> @^-1` [<span class="id">set</span> <span class="id">r</span>]) <span class="id">x</span>)) @^-1` <span class="id">B</span> <span class="kwd">by</span> <span class="id">move</span>=&gt; -&gt;.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">seteqP</span>; <span class="id">split</span> =&gt; <span class="id">x</span>/=;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">comp_preimage</span> <span class="id">_</span> <span class="id">snd</span> (<span class="id">k_</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#xsection_preimage_snd">n</a></span>)) <span class="id">xsection_preimage_snd</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">measurable_fun_preimage_integral</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">measurable_fun_integral_kernel</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d</span> <span class="id">d</span>' (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">X</a></span> : <span class="id">measurableType</span> <span class="id">d</span>) (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Y</a></span> : <span class="id">measurableType</span> <span class="id">d</span>') (<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">R</a></span> : <span class="id">realType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id">X</span> -&gt; {<span class="id">measure</span> <span class="id">set</span> <span class="id">Y</span> -&gt; \<span class="id">bar</span> <span class="id">R</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ml</span> : <span class="kwd">forall</span> <span class="id">U</span>, <span class="id">measurable</span> <span class="id">U</span> -&gt; <span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id">X</span>] (<span class="id">l</span> ^~ <span class="id">U</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span> : <span class="id">Y</span> -&gt; \<span class="id">bar</span> <span class="id">R</span>) (<span class="id">k0</span> : <span class="kwd">forall</span> <span class="id">z</span>, 0 &lt;= <span class="id">k</span> <span class="id">z</span>) (<span class="id">mk</span> : <span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id">Y</span>] <span class="id">k</span>) :<br/>
&nbsp;&nbsp;<span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id">X</span>] (<span class="kwd">fun</span> <span class="id">x</span> =&gt; \<span class="id">int</span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">_y</span> <span class="id">k</span> <span class="id">y</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
<span class="id">have</span> [<span class="id">k_</span> [<span class="id">ndk_</span> <span class="id">k_k</span>]] := <span class="id">approximation</span> <span class="id">measurableT</span> <span class="id">mk</span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">_</span> =&gt; <span class="id">k0</span> <span class="id">x</span>).<br/>
<span class="kwd">by</span> <span class="id">apply</span>: (<span class="id">measurable_fun_preimage_integral</span> <span class="id">ndk_</span> <span class="id">k_k</span>) =&gt; <span class="id">n</span> <span class="id">r</span>; <span class="id">exact</span>/<span class="id">ml</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id">integral_kcomp</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> <span class="id">d2</span> <span class="id">d3</span> (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">X</a></span> : <span class="id">measurableType</span> <span class="id">d</span>) (<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Y</a></span> : <span class="id">measurableType</span> <span class="id">d2</span>)<br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">Z</a></span> : <span class="id">measurableType</span> <span class="id">d3</span>) (<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">R</a></span> : <span class="id">realType</span>).<br/>
<span class="kwd">Variables</span> (<span class="id"><a href="mathcomp.analysis.kernel.html#integral_kcomp.R">l</a></span> : <span class="id">R</span>.-<span class="id">sfker</span> <span class="id">X</span> ~&gt; <span class="id">Y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.kernel.html#integral_kcomp.R">k</a></span> : <span class="id">R</span>.-<span class="id">sfker</span> [<span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">the</a></span> <span class="id">measurableType</span> <span class="id">_</span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.kernel.html#integral_kcomp.Y">X</a></span> * <span class="id">Y</span>] ~&gt; <span class="id">Z</span>).<br/>
<br/>
<span class="kwd">Let</span> <span class="id">integral_kcomp_indic</span> <span class="id">x</span> <span class="id">E</span> (<span class="id">mE</span> : <span class="id">measurable</span> <span class="id">E</span>) :<br/>
&nbsp;&nbsp;\<span class="id">int</span>[(<span class="id">l</span> \; <span class="id">k</span>) <span class="id">x</span>]<span class="id">_z</span> (\1<span class="id">_E</span> <span class="id">z</span>)%:<span class="id">E</span> = \<span class="id"><a href="mathcomp.analysis.kernel.html#integral_kcomp.l">int</a></span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">_y</span> (\<span class="id"><a href="mathcomp.analysis.kernel.html#integral_kcomp.k">int</a></span>[<span class="id">k</span> (<span class="id">x</span>, <span class="id">y</span>)]<span class="id">_z</span> (\1<span class="id">_E</span> <span class="id">z</span>)%:<span class="id">E</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
<span class="id">rewrite</span> <span class="id">integral_indic</span>//= /<span class="id">kcomp</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">eq_integral</span> =&gt; <span class="id">y</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">integral_indic</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">integral_kcomp_nnsfun</span> <span class="id">x</span> (<span class="id">f</span> : {<span class="id">nnsfun</span> <span class="id">Z</span> &gt;-&gt; <span class="id">R</span>}) :<br/>
&nbsp;&nbsp;\<span class="id">int</span>[(<span class="id">l</span> \; <span class="id">k</span>) <span class="id">x</span>]<span class="id">_z</span> (<span class="id">f</span> <span class="id">z</span>)%:<span class="id">E</span> = \<span class="id"><a href="mathcomp.analysis.kernel.html#integral_kcomp.l">int</a></span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">_y</span> (\<span class="id"><a href="mathcomp.analysis.kernel.html#integral_kcomp.k">int</a></span>[<span class="id">k</span> (<span class="id">x</span>, <span class="id">y</span>)]<span class="id">_z</span> (<span class="id">f</span> <span class="id">z</span>)%:<span class="id">E</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
<span class="id">under</span> [<span class="kwd">in</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">LHS</a></span>]<span class="id">eq_integral</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">fimfunE</span> -<span class="id">fsumEFin</span>//.<br/>
<span class="id">rewrite</span> <span class="id">ge0_integral_fsum</span>//; <span class="id">last</span> 2 <span class="id">first</span>.<br/>
&nbsp;&nbsp;- <span class="id">move</span>=&gt; <span class="id">r</span>; <span class="id">apply</span>/<span class="id">EFin_measurable_fun</span>/<span class="id">measurableT_comp</span> =&gt; [//|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">have</span> <span class="id">fr</span> : <span class="id">measurable</span> (<span class="id">f</span> @^-1` [<span class="id">set</span> <span class="id">r</span>]) <span class="kwd">by</span> <span class="id">exact</span>/<span class="id">measurable_sfunP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">_</span> : \1<span class="id">__</span> = <span class="id">mindic</span> <span class="id">R</span> <span class="id">fr</span>).<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">r</span> <span class="id">z</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">EFinM</span> <span class="id">nnfun_muleindic_ge0</span>.<br/>
<span class="id">under</span> [<span class="kwd">in</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">RHS</a></span>]<span class="id">eq_integral</span>.<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">y</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id">eq_integral</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">z</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">fimfunE</span> -<span class="id">fsumEFin</span>//; <span class="id">over</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> /= <span class="id">ge0_integral_fsum</span>//; <span class="id">last</span> 2 <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">move</span>=&gt; <span class="id">r</span>; <span class="id">apply</span>/<span class="id">EFin_measurable_fun</span>/<span class="id">measurableT_comp</span> =&gt; [//|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">have</span> <span class="id">fr</span> : <span class="id">measurable</span> (<span class="id">f</span> @^-1` [<span class="id">set</span> <span class="id">r</span>]) <span class="kwd">by</span> <span class="id">exact</span>/<span class="id">measurable_sfunP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">_</span> : \1<span class="id">__</span> = <span class="id">mindic</span> <span class="id">R</span> <span class="id">fr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">r</span> <span class="id">z</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">EFinM</span> <span class="id">nnfun_muleindic_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id">eq_fsbigr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">r</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">integralZl_indic</span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">f</span> @^-1` [<span class="id">set</span> <span class="id">r</span>]))//; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">r0</span>; <span class="id">rewrite</span> <span class="id">preimage_nnfun0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">integral_indic</span>// <span class="id">setIT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">over</span>.<br/>
&nbsp;&nbsp;<span class="id">over</span>.<br/>
<span class="id">rewrite</span> /= <span class="id">ge0_integral_fsum</span>//; <span class="id">last</span> 2 <span class="id">first</span>.<br/>
&nbsp;&nbsp;- <span class="id">move</span>=&gt; <span class="id">r</span>; <span class="id">apply</span>: <span class="id">measurable_funeM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">measurableT_comp</span> (<span class="id">measurable_kernel</span> <span class="id">k</span> (<span class="id">f</span> @^-1` [<span class="id">set</span> <span class="id">r</span>]) <span class="id">_</span>) <span class="id">_</span>.<br/>
&nbsp;&nbsp;- <span class="id">move</span>=&gt; <span class="id">n</span> <span class="id">y</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">have</span> := <span class="id">mulemu_ge0</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">f</span> @^-1` [<span class="id">set</span> <span class="id">n</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>; <span class="id">exact</span>: <span class="id">preimage_nnfun0</span>.<br/>
<span class="id">apply</span>: <span class="id">eq_fsbigr</span> =&gt; <span class="id">r</span> <span class="id">_</span>.<br/>
<span class="id">rewrite</span> (<span class="id">integralZl_indic</span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">f</span> @^-1` [<span class="id">set</span> <span class="id">r</span>]))//; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">preimage_nnfun0</span>.<br/>
<span class="id">rewrite</span> /= <span class="id">integral_kcomp_indic</span>; <span class="id">last</span> <span class="id">exact</span>/<span class="id">measurable_sfunP</span>.<br/>
<span class="id">have</span> [<span class="id">r0</span>|<span class="id">r0</span>] := <span class="id">leP</span> 0%<span class="id">R</span> <span class="id">r</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">ge0_integralZl</span>//; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">measurableT_comp</span> (<span class="id">measurable_kernel</span> <span class="id">k</span> (<span class="id">f</span> @^-1` [<span class="id">set</span> <span class="id">r</span>]) <span class="id">_</span>) <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">congr</span> (<span class="id">_</span> * <span class="id">_</span>); <span class="id">apply</span>: <span class="id">eq_integral</span> =&gt; <span class="id">y</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">integral_indic</span>// <span class="id">setIT</span>.<br/>
<span class="id">rewrite</span> <span class="id">integral0_eq</span> ?<span class="id">mule0</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">y</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">integral0_eq</span>// =&gt; <span class="id">z</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">preimage_nnfun0</span>// <span class="id">indic0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">integral0_eq</span>// =&gt; <span class="id">y</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">preimage_nnfun0</span>// <span class="id">measure0</span> <span class="id">mule0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">integral_kcomp</span> <span class="id">x</span> <span class="id">f</span> : (<span class="kwd">forall</span> <span class="id">z</span>, 0 &lt;= <span class="id">f</span> <span class="id">z</span>) -&gt; <span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id">Z</span>] <span class="id">f</span> -&gt;<br/>
&nbsp;&nbsp;\<span class="id">int</span>[(<span class="id">l</span> \; <span class="id">k</span>) <span class="id">x</span>]<span class="id">_z</span> <span class="id">f</span> <span class="id">z</span> = \<span class="id"><a href="mathcomp.analysis.kernel.html#integral_kcomp.l">int</a></span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">_y</span> (\<span class="id"><a href="mathcomp.analysis.kernel.html#integral_kcomp.k">int</a></span>[<span class="id">k</span> (<span class="id">x</span>, <span class="id">y</span>)]<span class="id">_z</span> <span class="id">f</span> <span class="id">z</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
<span class="id">move</span>=&gt; <span class="id">f0</span> <span class="id">mf</span>.<br/>
<span class="id">have</span> [<span class="id">f_</span> [<span class="id">ndf_</span> <span class="id">f_f</span>]] := <span class="id">approximation</span> <span class="id">measurableT</span> <span class="id">mf</span> (<span class="kwd">fun</span> <span class="id">z</span> <span class="id">_</span> =&gt; <span class="id">f0</span> <span class="id">z</span>).<br/>
<span class="id">transitivity</span> (\<span class="id">int</span>[(<span class="id">l</span> \; <span class="id">k</span>) <span class="id">x</span>]<span class="id"><a href="mathcomp.analysis.topology.html#lim">_z</a></span> (<span class="id">lim</span> (<span class="id">EFin</span> \<span class="id">o</span> <span class="id">f_</span>^~ <span class="id">z</span>))).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">eq_integral</span> =&gt; <span class="id">z</span> <span class="id">_</span>; <span class="id">apply</span>/<span class="id">esym</span>/<span class="id">cvg_lim</span> =&gt; //=; <span class="id">exact</span>: <span class="id">f_f</span>.<br/>
<span class="id">rewrite</span> <span class="id">monotone_convergence</span>//; <span class="id">last</span> 3 <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">n</span>; <span class="id">exact</span>/<span class="id">EFin_measurable_fun</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">n</span> <span class="id">z</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">z</span> <span class="id">_</span> <span class="id">a</span> <span class="id">b</span> /<span class="id">ndf_</span> /<span class="id">lefP</span> <span class="id">ab</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>.<br/>
<span class="id">rewrite</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">_</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">n</span> =&gt; \<span class="id"><a href="mathcomp.analysis.kernel.html#integral_kcomp.l">int</a></span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">_y</span> (\<span class="id"><a href="mathcomp.analysis.kernel.html#integral_kcomp.k">int</a></span>[<span class="id">k</span> (<span class="id">x</span>, <span class="id">y</span>)]<span class="id">_z</span> (<span class="id">f_</span> <span class="id">n</span> <span class="id">z</span>)%:<span class="id">E</span>)))//; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">n</span>; <span class="id">rewrite</span> <span class="id">integral_kcomp_nnsfun</span>.<br/>
<span class="id">transitivity</span> (\<span class="id"><a href="mathcomp.analysis.kernel.html#integral_kcomp.l">int</a></span>[<span class="id">l</span> <span class="id">x</span>]<span class="id">_y</span> <span class="id">lim</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; \<span class="id"><a href="mathcomp.analysis.kernel.html#integral_kcomp.k">int</a></span>[<span class="id">k</span> (<span class="id">x</span>, <span class="id">y</span>)]<span class="id">_z</span> (<span class="id">f_</span> <span class="id">n</span> <span class="id">z</span>)%:<span class="id">E</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -<span class="id">monotone_convergence</span>//; <span class="id">last</span> 3 <span class="id">first</span>.<br/>
&nbsp;&nbsp;- <span class="id">move</span>=&gt; <span class="id">n</span>; <span class="id">apply</span>: <span class="id">measurable_fun_integral_kernel</span> =&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">U</span> <span class="id">mU</span>; <span class="id">exact</span>: <span class="id">measurableT_comp</span> (<span class="id">measurable_kernel</span> <span class="id">k</span> <span class="id">_</span> <span class="id">mU</span>) <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">z</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exact</span>/<span class="id">EFin_measurable_fun</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">n</span> <span class="id">y</span> <span class="id">_</span>; <span class="id">apply</span>: <span class="id">integral_ge0</span> =&gt; // <span class="id">z</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>.<br/>
&nbsp;&nbsp;- <span class="id">move</span>=&gt; <span class="id">y</span> <span class="id">_</span> <span class="id">a</span> <span class="id">b</span> <span class="id">ab</span>; <span class="id">apply</span>: <span class="id">ge0_le_integral</span> =&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">z</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exact</span>/<span class="id">EFin_measurable_fun</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">z</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exact</span>/<span class="id">EFin_measurable_fun</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">move</span>: <span class="id">ab</span> =&gt; /<span class="id">ndf_</span> /<span class="id">lefP</span> <span class="id">ab</span> <span class="id">z</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>.<br/>
<span class="id">apply</span>: <span class="id">eq_integral</span> =&gt; <span class="id">y</span> <span class="id">_</span>; <span class="id">rewrite</span> -<span class="id">monotone_convergence</span>//; <span class="id">last</span> 3 <span class="id">first</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">n</span>; <span class="id">exact</span>/<span class="id">EFin_measurable_fun</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">n</span> <span class="id">z</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">z</span> <span class="id">_</span> <span class="id">a</span> <span class="id">b</span> /<span class="id">ndf_</span> /<span class="id">lefP</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">eq_integral</span> =&gt; <span class="id">z</span> <span class="id">_</span>; <span class="id">apply</span>/<span class="id">cvg_lim</span> =&gt; //; <span class="id">exact</span>: <span class="id">f_f</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">integral_kcomp</span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/tree/yoshihiro503%40generate_index">a fork of coq2html</a></div>
</body>
</html>
